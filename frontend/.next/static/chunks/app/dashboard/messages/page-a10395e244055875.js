(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5342],{5858:(e,a,t)=>{Promise.resolve().then(t.bind(t,5817))},5817:(e,a,t)=>{"use strict";t.d(a,{ChatLayout:()=>v});var r=t(5155),s=t(2115),n=t(3233),l=t(4525),i=t(2013),d=t(1160);function c(e){var a;let{conversation:t,onSelect:s}=e,{activeConversationId:n}=(0,l.L)(),c=n===t.id;return(0,r.jsxs)("button",{onClick:s,className:(0,d.cn)("w-full text-left p-3 rounded-lg flex items-center space-x-3 transition-colors",c?"bg-gray-100 dark:bg-gray-800":"hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:[(0,r.jsxs)(i.eu,{children:[(0,r.jsx)(i.BK,{src:t.participant.avatarUrl,alt:t.participant.name}),(0,r.jsx)(i.q5,{children:t.participant.name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,r.jsx)("p",{className:"font-semibold truncate",children:t.participant.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 truncate",children:null===(a=t.lastMessage)||void 0===a?void 0:a.content})]}),t.unreadCount>0&&(0,r.jsx)("span",{className:"bg-blue-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:t.unreadCount})]})}var o=t(8273);function u(e){let{isLoading:a,onSelectConversation:t}=e,{conversations:s}=(0,l.L)();return a?(0,r.jsx)("div",{className:"p-4",children:"Loading..."}):0===s.length?(0,r.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Tidak ada pesan."}):(0,r.jsx)(o.F,{className:"h-full",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Pesan"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsx)(c,{conversation:e,onSelect:()=>t(e.id)},e.id))})]})})}var f=t(613),x=t(7312),m=t(2389),h=t.n(m),p=t(2818);function j(e){let{userId:a,children:t}=e,{addMessage:n}=(0,l.L)();return(0,s.useEffect)(()=>{if(!a)return;let e=new(h())(p.env.NEXT_PUBLIC_PUSHER_KEY,{cluster:p.env.NEXT_PUBLIC_PUSHER_CLUSTER,authEndpoint:"/api/pusher/auth",auth:{headers:{}}});return e.subscribe("private-user-".concat(a)).bind("new-message",e=>{n(e)}),()=>{e.unsubscribe("private-user-".concat(a)),e.disconnect()}},[a,n]),(0,r.jsx)(r.Fragment,{children:t})}let N=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});function v(e){let{currentUser:a}=e,{setConversations:t,activeConversationId:i,setActiveConversationId:c}=(0,l.L)(),[o,m]=(0,s.useState)(!1),{data:h,isLoading:p}=(0,n.I)({queryKey:["conversations"],queryFn:x.lS});return(0,s.useEffect)(()=>{h&&t(h)},[h,t]),(0,r.jsx)(j,{userId:a.id,children:(0,r.jsxs)(N,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,r.jsx)("aside",{className:(0,d.cn)("w-full md:w-1/3 md:flex flex-col border-r transition-transform duration-300 ease-in-out",o?"-translate-x-full md:translate-x-0":"translate-x-0"),children:(0,r.jsx)(u,{isLoading:p,onSelectConversation:e=>{c(e),m(!0)}})}),(0,r.jsx)("main",{className:(0,d.cn)("w-full md:w-2/3 flex flex-col absolute md:static top-0 left-0 h-full bg-white transition-transform duration-300 ease-in-out",o?"translate-x-0":"translate-x-full md:translate-x-0"),children:i?(0,r.jsx)(f.l,{onBack:()=>{c(null),m(!1)}}):(0,r.jsx)("div",{className:"hidden md:flex h-full items-center justify-center text-gray-500",children:(0,r.jsx)("p",{children:"Pilih percakapan untuk memulai \uD83D\uDCAC"})})})]})})}N.displayName="Card",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",t),...s})}).displayName="CardHeader",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h3",{ref:a,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})}).displayName="CardTitle",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("p",{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",t),...s})}).displayName="CardDescription",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,d.cn)("p-6 pt-0",t),...s})}).displayName="CardContent",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,d.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"}},e=>{var a=a=>e(e.s=a);e.O(0,[1181,2651,511,3975,8813,613,8441,1517,7358],()=>a(5858)),_N_E=e.O()}]);