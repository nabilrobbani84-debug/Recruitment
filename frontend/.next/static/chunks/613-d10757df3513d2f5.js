"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[613],{613:(e,r,a)=>{a.d(r,{l:()=>N});var t=a(5155),s=a(2115),n=a(7882),l=a(4525),i=a(7312),o=a(5906),c=a(5848);let d=s.forwardRef((e,r)=>{let{className:a,icon:s,...n}=e;return(0,t.jsxs)("div",{className:"relative w-full",children:[s&&(0,t.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",children:s}),(0,t.jsx)("input",{className:"w-full ".concat(s?"pl-10":"pl-4"," pr-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 ").concat(a),ref:r,...n})]})});d.displayName="Input";var u=a(2538),m=a(4505),p=a(8283),f=a(814);function h(){let[e,r]=(0,s.useState)(""),{activeConversationId:a}=(0,l.L)(),n=(0,o.jE)(),h=(0,c.n)({mutationFn:e=>{if(!a)throw Error("Tidak ada percakapan aktif.");return(0,i._z)(a,{content:e})},onSuccess:()=>{r(""),n.invalidateQueries({queryKey:["messages",a]})},onError:e=>{f.oR.error("Gagal mengirim pesan: ".concat(e.message))}}),g=async r=>{r.preventDefault(),e.trim()&&!h.isPending&&h.mutate(e)};return(0,t.jsxs)("form",{onSubmit:g,className:"flex items-center space-x-2",children:[(0,t.jsx)(d,{value:e,onChange:e=>r(e.target.value),placeholder:"Ketik pesan...",autoComplete:"off",disabled:!a||h.isPending}),(0,t.jsx)(u.Button,{type:"submit",disabled:!a||!e.trim()||h.isPending,children:h.isPending?(0,t.jsx)(m.A,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(p.A,{className:"h-4 w-4"})})]})}var g=a(5459),x=a(1160),v=a(2013);function y(e){var r,a;let{message:s}=e,{user:n}=(0,g.A)(),l=!!n&&s.senderId===n.id,i=(null===(r=s.sender)||void 0===r?void 0:r.name.charAt(0))||"U",o=null===(a=s.sender)||void 0===a?void 0:a.avatarUrl;return(0,t.jsxs)("div",{className:(0,x.cn)("flex items-end gap-3",l?"justify-end":"justify-start"),children:[!l&&(0,t.jsxs)(v.eu,{className:"h-8 w-8",children:[(0,t.jsx)(v.BK,{src:o}),(0,t.jsx)(v.q5,{children:i})]}),(0,t.jsxs)("div",{className:(0,x.cn)("max-w-[70%] rounded-lg px-4 py-2",l?"rounded-br-none bg-blue-600 text-white":"rounded-bl-none bg-gray-100 dark:bg-gray-800"),children:[(0,t.jsx)("p",{className:"text-sm",children:s.content}),(0,t.jsx)("p",{className:(0,x.cn)("mt-1 text-right text-xs",l?"text-blue-200":"text-gray-500"),children:new Date(s.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})}var b=a(8273),j=a(434);let w=s.forwardRef((e,r)=>{let{className:a,orientation:s="horizontal",decorative:n=!0,...l}=e;return(0,t.jsx)(j.b,{ref:r,decorative:n,orientation:s,className:(0,x.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...l})});function N(e){let{onBack:r}=e,{activeConversationId:a,messages:o,setMessages:c,conversations:d}=(0,l.L)(),p=(0,s.useRef)(null),f=d.find(e=>e.id===a),{data:g,isLoading:x,fetchNextPage:j,hasNextPage:N,isFetchingNextPage:k}=(0,n.q)({queryKey:["messages",a],queryFn:e=>{let{pageParam:r}=e;return(0,i.vP)(a,r||1)},initialPageParam:1,getNextPageParam:e=>{if(e.meta.current_page<e.meta.last_page)return e.meta.current_page+1},enabled:!!a}),E=(0,s.useMemo)(()=>{var e;return null!==(e=null==g?void 0:g.pages.flatMap(e=>e.data).reverse())&&void 0!==e?e:[]},[g]);return((0,s.useEffect)(()=>{c(E)},[E,c]),(0,s.useEffect)(()=>{p.current&&p.current.scrollTo({top:p.current.scrollHeight,behavior:"smooth"})},[o]),f)?(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-4 border-b flex items-center space-x-3",children:[(0,t.jsx)(u.Button,{variant:"ghost",size:"icon",className:"md:hidden",onClick:r,children:"<"}),(0,t.jsxs)(v.eu,{children:[(0,t.jsx)(v.BK,{src:f.participant.avatarUrl}),(0,t.jsx)(v.q5,{children:f.participant.name.charAt(0).toUpperCase()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold",children:f.participant.name}),(0,t.jsx)("p",{className:"text-sm text-green-500",children:"Online"})]})]}),(0,t.jsx)(b.F,{className:"flex-1 p-4",ref:p,children:(0,t.jsxs)("div",{className:"space-y-4",children:[N&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(u.Button,{onClick:()=>j(),variant:"link",disabled:k,children:k?(0,t.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Muat pesan sebelumnya"})}),x&&(0,t.jsx)("p",{className:"text-center text-gray-500",children:"Memuat pesan..."}),E.map(e=>(0,t.jsx)(y,{message:e},e.id))]})}),(0,t.jsx)(w,{}),(0,t.jsx)("div",{className:"p-4 bg-white dark:bg-gray-900",children:(0,t.jsx)(h,{})})]}):(0,t.jsx)("div",{className:"flex h-full items-center justify-center text-gray-500",children:(0,t.jsx)("p",{children:"Pilih percakapan untuk memulai."})})}w.displayName=j.b.displayName},2538:(e,r,a)=>{a.d(r,{Button:()=>o});var t=a(5155),s=a(2115),n=a(1027),l=a(1160);let i=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,r)=>{let{className:a,variant:s,size:n,...o}=e;return(0,t.jsx)("button",{className:(0,l.cn)(i({variant:s,size:n,className:a})),ref:r,...o})});o.displayName="Button"},2013:(e,r,a)=>{a.d(r,{BK:()=>o,eu:()=>i,q5:()=>c});var t=a(5155),s=a(2115),n=a(3387),l=a(1160);let i=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(n.bL,{ref:r,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});i.displayName=n.bL.displayName;let o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(n._V,{ref:r,className:(0,l.cn)("aspect-square h-full w-full",a),...s})});o.displayName=n._V.displayName;let c=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(n.H4,{ref:r,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",a),...s})});c.displayName=n.H4.displayName},8273:(e,r,a)=>{a.d(r,{F:()=>i});var t=a(5155),s=a(2115),n=a(7665),l=a(1160);let i=s.forwardRef((e,r)=>{let{className:a,children:s,...i}=e;return(0,t.jsxs)(n.bL,{ref:r,className:(0,l.cn)("relative overflow-hidden",a),...i,children:[(0,t.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,t.jsx)(o,{}),(0,t.jsx)(n.OK,{})]})});i.displayName=n.bL.displayName;let o=s.forwardRef((e,r)=>{let{className:a,orientation:s="vertical",...i}=e;return(0,t.jsx)(n.Ze,{ref:r,orientation:s,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,t.jsx)(n.zi,{className:"relative flex-1 rounded-full bg-gray-200 dark:bg-gray-700"})})});o.displayName=n.Ze.displayName},5459:(e,r,a)=>{a.d(r,{A:()=>i,O:()=>l});var t=a(5155),s=a(2115);let n=(0,s.createContext)(void 0),l=e=>{let{children:r}=e,[a,l]=(0,s.useState)(null),[i,o]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{console.log("Checking user session (placeholder)...")}catch(e){console.error("Error checking user session:",e),l(null)}finally{o(!1)}})()},[]);let c=async(e,r)=>{o(!0);try{if(console.log("Login process (placeholder)...",{email:e,pass:r}),"candidate@example.com"===e&&"password"===r){let r={id:"1",email:e,name:"Candidate User",role:"candidate"};return l(r),r}if("employer@example.com"===e&&"password"===r){let r={id:"2",email:e,name:"Employer User",role:"employer"};return l(r),r}throw Error("Email atau password salah.")}catch(e){throw console.error("Login failed:",e),e}finally{o(!1)}},d=async e=>{},u=async()=>{};return(0,t.jsx)(n.Provider,{value:{user:a,isLoading:i,login:c,register:d,logout:u},children:r})},i=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1160:(e,r,a)=>{a.d(r,{cn:()=>n});var t=a(3463),s=a(9795);function n(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.QP)((0,t.$)(r))}},7312:(e,r,a)=>{a.d(r,{_z:()=>o,lS:()=>l,vP:()=>i});var t=a(2651),s=a(2818);let n=t.A.create({baseURL:s.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api/v1",headers:{Accept:"application/json","Content-Type":"application/json"}});n.interceptors.request.use(e=>{let r=localStorage.getItem("authToken");return r&&(e.headers.Authorization="Bearer ".concat(r)),e}),n.interceptors.response.use(e=>e,e=>{var r;return console.error("API Error:",(null===(r=e.response)||void 0===r?void 0:r.data)||e.message),Promise.reject(e)});let l=async()=>{try{return(await n.get("/candidate/applications")).data}catch(e){throw console.error("Error fetching conversations:",e),Error("Gagal mengambil daftar percakapan.")}},i=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)throw Error("ID percakapan dibutuhkan.");try{return(await n.get("/conversations/".concat(e,"/messages"),{params:{page:r}})).data}catch(r){throw console.error("Error fetching messages for conversation ".concat(e,":"),r),Error("Gagal mengambil pesan.")}},o=async(e,r)=>{let{content:a,file:t}=r;if(!a&&!t)throw Error("Pesan harus berisi teks atau file.");let s=new FormData;a&&s.append("content",a),t&&s.append("file",t);try{return(await n.post("/conversations/".concat(e,"/messages"),s,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Error sending message to conversation ".concat(e,":"),r),Error("Gagal mengirim pesan.")}}},4525:(e,r,a)=>{a.d(r,{L:()=>n});var t=a(9827),s=a(709);let n=(0,t.v)()((0,s.lt)(e=>({conversations:[],activeConversationId:null,messages:[],setConversations:r=>e({conversations:r}),setActiveConversationId:r=>e({activeConversationId:r,messages:[]}),setMessages:r=>e({messages:r}),addMessage:r=>e(e=>({messages:[...e.messages,r]}))})))}}]);