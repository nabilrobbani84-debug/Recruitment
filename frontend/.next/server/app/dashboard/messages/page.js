(()=>{var t={};t.id=342,t.ids=[342],t.modules={10846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:t=>{"use strict";t.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:t=>{"use strict";t.exports=require("assert")},79428:t=>{"use strict";t.exports=require("buffer")},79646:t=>{"use strict";t.exports=require("child_process")},55511:t=>{"use strict";t.exports=require("crypto")},94735:t=>{"use strict";t.exports=require("events")},29021:t=>{"use strict";t.exports=require("fs")},81630:t=>{"use strict";t.exports=require("http")},55591:t=>{"use strict";t.exports=require("https")},91645:t=>{"use strict";t.exports=require("net")},21820:t=>{"use strict";t.exports=require("os")},33873:t=>{"use strict";t.exports=require("path")},27910:t=>{"use strict";t.exports=require("stream")},34631:t=>{"use strict";t.exports=require("tls")},83997:t=>{"use strict";t.exports=require("tty")},79551:t=>{"use strict";t.exports=require("url")},28354:t=>{"use strict";t.exports=require("util")},74075:t=>{"use strict";t.exports=require("zlib")},825:(t,e,r)=>{"use strict";r.r(e),r.d(e,{GlobalError:()=>o.a,__next_app__:()=>l,pages:()=>u,routeModule:()=>d,tree:()=>c});var s=r(70260),n=r(28203),i=r(25155),o=r.n(i),a=r(67292),h={};for(let t in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(t)&&(h[t]=()=>a[t]);r.d(e,h);let c=["",{children:["dashboard",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,44082)),"C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\app\\dashboard\\messages\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,83748)),"C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\app\\dashboard\\layout.tsx"],metadata:{icon:[async t=>(await Promise.resolve().then(r.bind(r,46055))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async t=>(await Promise.resolve().then(r.bind(r,46055))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\app\\dashboard\\messages\\page.tsx"],l={require:r,loadChunk:()=>Promise.resolve()},d=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/dashboard/messages/page",pathname:"/dashboard/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},98862:(t,e,r)=>{Promise.resolve().then(r.bind(r,25156))},54966:(t,e,r)=>{Promise.resolve().then(r.bind(r,15759))},58829:(t,e,r)=>{Promise.resolve().then(r.t.bind(r,59607,23))},22445:(t,e,r)=>{Promise.resolve().then(r.t.bind(r,28531,23))},15759:(t,e,r)=>{"use strict";r.d(e,{ChatLayout:()=>v});var s=r(45512),n=r(58009),i=r(4410),o=r(79514),a=r(49723),h=r(88283),c=r(79882);function u({conversation:t,onSelect:e}){let{activeConversationId:r}=(0,a.L)(),n=r===t.id;return(0,s.jsxs)("button",{onClick:e,className:(0,c.cn)("w-full text-left p-3 rounded-lg flex items-center space-x-3 transition-colors",n?"bg-gray-100 dark:bg-gray-800":"hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:[(0,s.jsxs)(h.eu,{children:[(0,s.jsx)(h.BK,{src:t.participant.avatarUrl,alt:t.participant.name}),(0,s.jsx)(h.q5,{children:t.participant.name.charAt(0)})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,s.jsx)("p",{className:"font-semibold truncate",children:t.participant.name}),(0,s.jsx)("p",{className:"text-sm text-gray-500 truncate",children:t.lastMessage?.content})]}),t.unreadCount>0&&(0,s.jsx)("span",{className:"bg-blue-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:t.unreadCount})]})}var l=r(10325);function d({isLoading:t,onSelectConversation:e}){let{conversations:r}=(0,a.L)();return t?(0,s.jsx)("div",{className:"p-4",children:"Loading..."}):0===r.length?(0,s.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Tidak ada pesan."}):(0,s.jsx)(l.F,{className:"h-full",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Pesan"}),(0,s.jsx)("div",{className:"space-y-2",children:r.map(t=>(0,s.jsx)(u,{conversation:t,onSelect:()=>e(t.id)},t.id))})]})})}var f=r(52470),p=r(36257);function g({userId:t,children:e}){let{addMessage:r}=(0,a.L)();return(0,s.jsx)(s.Fragment,{children:e})}r(57981);let _=n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("div",{ref:r,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));function v({currentUser:t}){var e;let{setConversations:r,activeConversationId:h,setActiveConversationId:u}=(0,a.L)(),[l,v]=(0,n.useState)(!1),{data:m,isLoading:b}=(e={queryKey:["conversations"],queryFn:p.lS},(0,o.t)(e,i.$,void 0));return(0,s.jsx)(g,{userId:t.id,children:(0,s.jsxs)(_,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,s.jsx)("aside",{className:(0,c.cn)("w-full md:w-1/3 md:flex flex-col border-r transition-transform duration-300 ease-in-out",l?"-translate-x-full md:translate-x-0":"translate-x-0"),children:(0,s.jsx)(d,{isLoading:b,onSelectConversation:t=>{u(t),v(!0)}})}),(0,s.jsx)("main",{className:(0,c.cn)("w-full md:w-2/3 flex flex-col absolute md:static top-0 left-0 h-full bg-white transition-transform duration-300 ease-in-out",l?"translate-x-0":"translate-x-full md:translate-x-0"),children:h?(0,s.jsx)(f.l,{onBack:()=>{u(null),v(!1)}}):(0,s.jsx)("div",{className:"hidden md:flex h-full items-center justify-center text-gray-500",children:(0,s.jsx)("p",{children:"Pilih percakapan untuk memulai \uD83D\uDCAC"})})})]})})}_.displayName="Card",n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("div",{ref:r,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",t),...e})).displayName="CardHeader",n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("h3",{ref:r,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",t),...e})).displayName="CardTitle",n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("p",{ref:r,className:(0,c.cn)("text-sm text-muted-foreground",t),...e})).displayName="CardDescription",n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("div",{ref:r,className:(0,c.cn)("p-6 pt-0",t),...e})).displayName="CardContent",n.forwardRef(({className:t,...e},r)=>(0,s.jsx)("div",{ref:r,className:(0,c.cn)("flex items-center p-6 pt-0",t),...e})).displayName="CardFooter"},57981:(t,e,r)=>{t.exports=function(t){var e={};function r(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e||4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,(function(e){return t[e]}).bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=21)}([function(t,e){t.exports=r(28354)},function(t,e,r){var s=r(22),n=s.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function o(t,e,r){return n(t,e,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=s:(i(s,e),e.Buffer=o),i(n,o),o.from=function(t,e,r){if("number"==typeof t)throw TypeError("Argument must not be a number");return n(t,e,r)},o.alloc=function(t,e,r){if("number"!=typeof t)throw TypeError("Argument must be a number");var s=n(t);return void 0!==e?"string"==typeof r?s.fill(e,r):s.fill(e):s.fill(0),s},o.allocUnsafe=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return s.SlowBuffer(t)}},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(23).EventEmitter,i=r(0),o=r(24),a=r(9),h=r(25),c=function(t,e,r){n.call(this),c.validateOptions(r||{},["maxLength","masking","requireMasking","protocols"]),this._request=t,this._reader=new h,this._options=r||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new a,this.__queue=[],this.readyState=0,this.url=e,this.io=new o.IO(this),this.messages=new o.Messages(this),this._bindEventListeners()};i.inherits(c,n),c.isWebSocket=function(t){var e=t.headers.connection||"",r=t.headers.upgrade||"";return"GET"===t.method&&e.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&"websocket"===r.toLowerCase()},c.validateOptions=function(t,e){for(var r in t)if(0>e.indexOf(r))throw Error("Unrecognized option: "+r)};var u={MAX_LENGTH:0x3ffffff,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var t=this;this.messages.on("error",function(){}),this.on("message",function(e){var r=t.messages;r.readable&&r.emit("data",e.data)}),this.on("error",function(e){var r=t.messages;r.readable&&r.emit("error",e)}),this.on("close",function(){var e=t.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(t){return!1},setHeader:function(t,e){return!(this.readyState>0)&&(this._headers.set(t,e),!0)},start:function(){var t;if(0!==this.readyState)return!1;if(!c.isWebSocket(this._request))return this._failHandshake(Error("Not a WebSocket request"));try{t=this._handshakeResponse()}catch(t){return this._failHandshake(t)}return this._write(t),-1!==this._stage&&this._open(),!0},_failHandshake:function(t){var e=new a;return e.set("Content-Type","text/plain"),e.set("Content-Length",s.byteLength(t.message,"utf8")),e=["HTTP/1.1 400 Bad Request",e.toString(),t.message],this._write(s.from(e.join("\r\n"),"utf8")),this._fail("protocol_error",t.message),!1},text:function(t){return this.frame(t)},binary:function(t){return!1},ping:function(){return!1},pong:function(){return!1},close:function(t,e){return 1===this.readyState&&(this.readyState=3,this.emit("close",new c.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(t){this.frame.apply(this,t)},this),this.__queue=[],this.emit("open",new c.OpenEvent)},_queue:function(t){return this.__queue.push(t),!0},_write:function(t){var e=this.io;e.readable&&e.emit("data",t)},_fail:function(t,e){this.readyState=2,this.emit("error",Error(e)),this.close()}};for(var l in u)c.prototype[l]=u[l];c.ConnectEvent=function(){},c.OpenEvent=function(){},c.CloseEvent=function(t,e){this.code=t,this.reason=e},c.MessageEvent=function(t){this.data=t},c.PingEvent=function(t){this.data=t},c.PongEvent=function(t){this.data=t},t.exports=c},function(t,e){t.exports=r(55511)},function(t,e,r){"use strict";var s=r(2),n=r(26),i=r(37);t.exports={client:function(t,e){return void 0===(e=e||{}).masking&&(e.masking=!0),new n(t,e)},server:function(t){return void 0===(t=t||{}).requireMasking&&(t.requireMasking=!0),new i(t)},http:function(){return i.http.apply(i,arguments)},isSecureRequest:function(t){return i.isSecureRequest(t)},isWebSocket:function(t){return s.isWebSocket(t)},validateOptions:function(t,e){s.validateOptions(t,e)}}},function(t,e){t.exports=r(27910)},function(t,e){t.exports=r(79551)},function(t,e,r){"use strict";var s=function(t,e){for(var r in this.type=t,e)this[r]=e[r]};s.prototype.initEvent=function(t,e,r){this.type=t,this.bubbles=e,this.cancelable=r},s.prototype.stopPropagation=function(){},s.prototype.preventDefault=function(){},s.CAPTURING_PHASE=1,s.AT_TARGET=2,s.BUBBLING_PHASE=3,t.exports=s},function(t,e,r){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){void 0===t&&(t="="),this._paddingCharacter=t}return t.prototype.encodedLength=function(t){return this._paddingCharacter?(t+2)/3*4|0:(8*t+5)/6|0},t.prototype.encode=function(t){for(var e="",r=0;r<t.length-2;r+=3){var s=t[r]<<16|t[r+1]<<8|t[r+2];e+=this._encodeByte(s>>>18&63),e+=this._encodeByte(s>>>12&63),e+=this._encodeByte(s>>>6&63),e+=this._encodeByte(s>>>0&63)}var n=t.length-r;if(n>0){var s=t[r]<<16|(2===n?t[r+1]<<8:0);e+=this._encodeByte(s>>>18&63),e+=this._encodeByte(s>>>12&63),2===n?e+=this._encodeByte(s>>>6&63):e+=this._paddingCharacter||"",e+=this._paddingCharacter||""}return e},t.prototype.maxDecodedLength=function(t){return this._paddingCharacter?t/4*3|0:(6*t+7)/8|0},t.prototype.decodedLength=function(t){return this.maxDecodedLength(t.length-this._getPaddingLength(t))},t.prototype.decode=function(t){if(0===t.length)return new Uint8Array(0);for(var e=this._getPaddingLength(t),r=t.length-e,s=new Uint8Array(this.maxDecodedLength(r)),n=0,i=0,o=0,a=0,h=0,c=0,u=0;i<r-4;i+=4)a=this._decodeChar(t.charCodeAt(i+0)),h=this._decodeChar(t.charCodeAt(i+1)),c=this._decodeChar(t.charCodeAt(i+2)),u=this._decodeChar(t.charCodeAt(i+3)),s[n++]=a<<2|h>>>4,s[n++]=h<<4|c>>>2,s[n++]=c<<6|u,o|=256&a,o|=256&h,o|=256&c,o|=256&u;if(i<r-1&&(a=this._decodeChar(t.charCodeAt(i)),h=this._decodeChar(t.charCodeAt(i+1)),s[n++]=a<<2|h>>>4,o|=256&a,o|=256&h),i<r-2&&(c=this._decodeChar(t.charCodeAt(i+2)),s[n++]=h<<4|c>>>2,o|=256&c),i<r-3&&(u=this._decodeChar(t.charCodeAt(i+3)),s[n++]=c<<6|u,o|=256&u),0!==o)throw Error("Base64Coder: incorrect characters for decoding");return s},t.prototype._encodeByte=function(t){var e=t;return e+=65,e+=25-t>>>8&6,e+=51-t>>>8&-75,e+=61-t>>>8&-15,String.fromCharCode(e+=62-t>>>8&3)},t.prototype._decodeChar=function(t){return 256+((42-t&t-44)>>>8&-256+t-43+62)+((46-t&t-48)>>>8&-256+t-47+63)+((47-t&t-58)>>>8&-256+t-48+52)+((64-t&t-91)>>>8&-256+t-65+0)+((96-t&t-123)>>>8&-256+t-97+26)},t.prototype._getPaddingLength=function(t){var e=0;if(this._paddingCharacter){for(var r=t.length-1;r>=0&&t[r]===this._paddingCharacter;r--)e++;if(t.length<4||e>2)throw Error("Base64Coder: incorrect padding")}return e},t}();e.Coder=i;var o=new i;e.encode=function(t){return o.encode(t)},e.decode=function(t){return o.decode(t)};var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype._encodeByte=function(t){var e=t;return e+=65,e+=25-t>>>8&6,e+=51-t>>>8&-75,e+=61-t>>>8&-13,String.fromCharCode(e+=62-t>>>8&49)},e.prototype._decodeChar=function(t){return 256+((44-t&t-46)>>>8&-256+t-45+62)+((94-t&t-96)>>>8&-256+t-95+63)+((47-t&t-58)>>>8&-256+t-48+52)+((64-t&t-91)>>>8&-256+t-65+0)+((96-t&t-123)>>>8&-256+t-97+26)},e}(i);e.URLSafeCoder=a;var h=new a;e.encodeURLSafe=function(t){return h.encode(t)},e.decodeURLSafe=function(t){return h.decode(t)},e.encodedLength=function(t){return o.encodedLength(t)},e.maxDecodedLength=function(t){return o.maxDecodedLength(t)},e.decodedLength=function(t){return o.decodedLength(t)}},function(t,e,r){"use strict";var s=function(){this.clear()};s.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],s.prototype.clear=function(){this._sent={},this._lines=[]},s.prototype.set=function(t,e){if(void 0!==e){t=this._strip(t),e=this._strip(e);var r=t.toLowerCase();(!this._sent.hasOwnProperty(r)||this.ALLOWED_DUPLICATES.indexOf(r)>=0)&&(this._sent[r]=!0,this._lines.push(t+": "+e+"\r\n"))}},s.prototype.toString=function(){return this._lines.join("")},s.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")},t.exports=s},function(t,e,r){"use strict";var s=r(27).HTTPParser,n=r(1).Buffer,i={request:s.REQUEST||"request",response:s.RESPONSE||"response"},o=function(t){this._type=t,this._parser=new s(i[t]),this._complete=!1,this.headers={};var e=null,r=this;this._parser.onHeaderField=function(t,r,s){e=t.toString("utf8",r,r+s).toLowerCase()},this._parser.onHeaderValue=function(t,s,n){var i=t.toString("utf8",s,s+n);r.headers.hasOwnProperty(e)?r.headers[e]+=", "+i:r.headers[e]=i},this._parser.onHeadersComplete=this._parser[s.kOnHeadersComplete]=function(t,e,s,n,i,a){var h=arguments[0];if("object"==typeof h&&(n=h.method,i=h.url,a=h.statusCode,s=h.headers),r.method="number"==typeof n?o.METHODS[n]:n,r.statusCode=a,r.url=i,s){for(var c,u,l=0,d=s.length;l<d;l+=2)c=s[l].toLowerCase(),u=s[l+1],r.headers.hasOwnProperty(c)?r.headers[c]+=", "+u:r.headers[c]=u;r._complete=!0}}};o.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var a=process.version?process.version.match(/[0-9]+/g).map(function(t){return parseInt(t,10)}):[];0===a[0]&&12===a[1]&&(o.METHODS[16]="REPORT",o.METHODS[17]="MKACTIVITY",o.METHODS[18]="CHECKOUT",o.METHODS[19]="MERGE",o.METHODS[20]="M-SEARCH",o.METHODS[21]="NOTIFY",o.METHODS[22]="SUBSCRIBE",o.METHODS[23]="UNSUBSCRIBE",o.METHODS[24]="PATCH",o.METHODS[25]="PURGE"),o.prototype.isComplete=function(){return this._complete},o.prototype.parse=function(t){var e=this._parser.execute(t,0,t.length);if("number"!=typeof e){this.error=e,this._complete=!0;return}this._complete&&(this.body=e<t.length?t.slice(e):n.alloc(0))},t.exports=o},function(t,e,r){"use strict";var s=r(5).Stream,n=r(0),i=r(4),o=r(16),a=r(7),h=function(t){t=t||{},i.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var r in e)this._driver.setHeader(r,e[r]);var s=t.extensions;s&&[].concat(s).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=h.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var n=this;this._driver.on("open",function(t){n._open()}),this._driver.on("message",function(t){n._receiveMessage(t.data)}),this._driver.on("close",function(t){n._beginClose(t.reason,t.code)}),this._driver.on("error",function(t){n._emitError(t.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){n.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){n._pingId+=1,n.ping(n._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};n.inherits(h,s),h.CONNECTING=0,h.OPEN=1,h.CLOSING=2,h.CLOSED=3,h.CLOSE_TIMEOUT=3e4;var c={write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return!(this.readyState>h.OPEN)&&(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return!(this.readyState>h.OPEN)&&this._driver.ping(t,e)},close:function(t,e){if(void 0===t&&(t=1e3),void 0===e&&(e=""),1e3!==t&&(t<3e3||t>4999))throw Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");this.readyState!==h.CLOSED&&(this.readyState=h.CLOSING);var r=this;this._closeTimer=setTimeout(function(){r._beginClose("",1006)},h.CLOSE_TIMEOUT),this._driver.close(e,t)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===h.CONNECTING){this.readyState=h.OPEN,this.protocol=this._driver.protocol||"";var t=new a("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>h.OPEN)return!1;this.readable&&this.emit("data",t);var e=new a("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=h.CLOSING)){var e=new a("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==h.CLOSED&&(this.readyState=h.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==h.CLOSED){this.readyState=h.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=new a("close",{code:this._closeParams?this._closeParams[1]:1006,reason:t});e.initEvent("close",!1,!1),this.dispatchEvent(e)}}};for(var u in c)h.prototype[u]=c[u];for(var l in o)h.prototype[l]=o[l];t.exports=h},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(3),i=r(0),o=r(29),a=r(2),h=r(34),c=r(35),u=function(t,e,r){if(a.apply(this,arguments),this._extensions=new o,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},"string"==typeof this._protocols&&(this._protocols=this._protocols.split(/ *, */)),this._request){var s=this._request.headers["sec-websocket-protocol"],n=this._protocols;void 0!==s&&("string"==typeof s&&(s=s.split(/ *, */)),this.protocol=s.filter(function(t){return n.indexOf(t)>=0})[0]),this.version="hybi-"+u.VERSION}};i.inherits(u,a),u.VERSION="13",u.mask=function(t,e,r){if(!e||0===e.length)return t;r=r||0;for(var s=0,n=t.length-r;s<n;s++)t[r+s]=t[r+s]^e[s%4];return t},u.generateAccept=function(t){var e=n.createHash("sha1");return e.update(t+u.GUID),e.digest("base64")},u.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var l={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(t){return this._extensions.add(t),!0},parse:function(t){this._reader.put(t);for(var e=!0;e;)switch(this._stage){case 0:(e=this._reader.read(1))&&this._parseOpcode(e[0]);break;case 1:(e=this._reader.read(1))&&this._parseLength(e[0]);break;case 2:(e=this._reader.read(this._frame.lengthBytes))&&this._parseExtendedLength(e);break;case 3:(e=this._reader.read(4))&&(this._stage=4,this._frame.maskingKey=e);break;case 4:(e=this._reader.read(this._frame.length))&&(this._stage=0,this._emitFrame(e));break;default:e=null}},text:function(t){return!(this.readyState>1)&&this.frame(t,"text")},binary:function(t){return!(this.readyState>1)&&this.frame(t,"binary")},ping:function(t,e){return!(this.readyState>1)&&(t=t||"",e&&(this._pingCallbacks[t]=e),this.frame(t,"ping"))},pong:function(t){return!(this.readyState>1)&&(t=t||"",this.frame(t,"pong"))},close:function(t,e){return(t=t||"",e=e||this.ERRORS.normal_closure,this.readyState<=0)?(this.readyState=3,this.emit("close",new a.CloseEvent(e,t)),!0):1===this.readyState&&(this.readyState=2,this._extensions.close(function(){this.frame(t,"close",e)},this),!0)},frame:function(t,e,r){if(this.readyState<=0)return this._queue([t,e,r]);if(this.readyState>2)return!1;t instanceof Array&&(t=s.from(t)),"number"==typeof t&&(t=t.toString());var i,o,a=new c,u="string"==typeof t;a.rsv1=a.rsv2=a.rsv3=!1,a.opcode=this.OPCODES[e||(u?"text":"binary")],i=u?s.from(t,"utf8"):t,r&&(o=i,(i=s.allocUnsafe(2+o.length)).writeUInt16BE(r,0),o.copy(i,2)),a.data=i;var l=function(t){var e=new h;e.final=!0,e.rsv1=t.rsv1,e.rsv2=t.rsv2,e.rsv3=t.rsv3,e.opcode=t.opcode,e.masked=!!this._masking,e.length=t.data.length,e.payload=t.data,e.masked&&(e.maskingKey=n.randomBytes(4)),this._sendFrame(e)};return this.MESSAGE_OPCODES.indexOf(a.opcode)>=0?this._extensions.processOutgoingMessage(a,function(t,e){if(t)return this._fail("extension_error",t.message);l.call(this,e)},this):l.call(this,a),!0},_sendFrame:function(t){var e=t.length,r=e<=125?2:e<=65535?4:10,n=r+(t.masked?4:0),i=s.allocUnsafe(n+e),o=t.masked?this.MASK:0;i[0]=(t.final?this.FIN:0)|(t.rsv1?this.RSV1:0)|(t.rsv2?this.RSV2:0)|(t.rsv3?this.RSV3:0)|t.opcode,e<=125?i[1]=o|e:e<=65535?(i[1]=126|o,i.writeUInt16BE(e,2)):(i[1]=127|o,i.writeUInt32BE(Math.floor(e/0x100000000),2),i.writeUInt32BE(e%0x100000000,6)),t.payload.copy(i,n),t.masked&&(t.maskingKey.copy(i,r),u.mask(i,t.maskingKey,n)),this._write(i)},_handshakeResponse:function(){var t=this._request.headers["sec-websocket-key"],e=this._request.headers["sec-websocket-version"];if(e!==u.VERSION)throw Error("Unsupported WebSocket version: "+e);if("string"!=typeof t)throw Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",u.generateAccept(t)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var r=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);r&&this._headers.set("Sec-WebSocket-Extensions",r);var n=["HTTP/1.1 101 Switching Protocols",this._headers.toString(),""];return s.from(n.join("\r\n"),"utf8")},_shutdown:function(t,e,r){delete this._frame,delete this._message,this._stage=5;var s=1===this.readyState;this.readyState=2,this._extensions.close(function(){s&&this.frame(e,"close",t),this.readyState=3,r&&this.emit("error",Error(e)),this.emit("close",new a.CloseEvent(t,e))},this)},_fail:function(t,e){this.readyState>1||this._shutdown(this.ERRORS[t],e,!0)},_parseOpcode:function(t){var e=[this.RSV1,this.RSV2,this.RSV3].map(function(e){return(t&e)===e}),r=this._frame=new h;return(r.final=(t&this.FIN)===this.FIN,r.rsv1=e[0],r.rsv2=e[1],r.rsv3=e[2],r.opcode=t&this.OPCODE,this._stage=1,this._extensions.validFrameRsv(r))?0>this.OPCODE_CODES.indexOf(r.opcode)?this._fail("protocol_error","Unrecognized frame opcode: "+r.opcode):0>this.MESSAGE_OPCODES.indexOf(r.opcode)&&!r.final?this._fail("protocol_error","Received fragmented control frame: opcode = "+r.opcode):this._message&&this.OPENING_OPCODES.indexOf(r.opcode)>=0?this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished"):void 0:this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(r.rsv1?1:0)+", reserved2 = "+(r.rsv2?1:0)+", reserved3 = "+(r.rsv3?1:0))},_parseLength:function(t){var e=this._frame;if(e.masked=(t&this.MASK)===this.MASK,e.length=t&this.LENGTH,e.length>=0&&e.length<=125){if(this._stage=e.masked?3:4,!this._checkFrameLength())return}else this._stage=2,e.lengthBytes=126===e.length?2:8;if(this._requireMasking&&!e.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(t){var e=this._frame;if(e.length=this._readUInt(t),this._stage=e.masked?3:4,0>this.MESSAGE_OPCODES.indexOf(e.opcode)&&e.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+e.length);if(!this._checkFrameLength())return},_checkFrameLength:function(){return!((this._message?this._message.length:0)+this._frame.length>this._maxLength)||(this._fail("too_large","WebSocket frame length too large"),!1)},_emitFrame:function(t){var e,r,s,n,i,o=this._frame,h=o.payload=u.mask(t,o.maskingKey),l=o.opcode;if(delete this._frame,l===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(o)}if((l===this.OPCODES.text||l===this.OPCODES.binary)&&(this._message=new c,this._message.pushFrame(o)),o.final&&this.MESSAGE_OPCODES.indexOf(l)>=0)return this._emitMessage(this._message);l===this.OPCODES.close&&(r=h.length>=2?h.readUInt16BE(0):null,s=h.length>2?this._encode(h.slice(2)):null,0!==h.length&&!(null!==r&&r>=this.MIN_RESERVED_ERROR&&r<=this.MAX_RESERVED_ERROR)&&0>this.ERROR_CODES.indexOf(r)&&(r=this.ERRORS.protocol_error),(h.length>125||h.length>2&&!s)&&(r=this.ERRORS.protocol_error),this._shutdown(r||this.DEFAULT_ERROR_CODE,s||"")),l===this.OPCODES.ping&&(this.frame(h,"pong"),this.emit("ping",new a.PingEvent(h.toString()))),l===this.OPCODES.pong&&(i=(n=this._pingCallbacks)[e=this._encode(h)],delete n[e],i&&i(),this.emit("pong",new a.PongEvent(h.toString())))},_emitMessage:function(t){var t=this._message;t.read(),delete this._message,this._extensions.processIncomingMessage(t,function(t,e){if(t)return this._fail("extension_error",t.message);var r=e.data;if(e.opcode===this.OPCODES.text&&(r=this._encode(r)),null===r)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new a.MessageEvent(r))},this)},_encode:function(t){try{var e=t.toString("binary",0,t.length);if(!this.UTF8_MATCH.test(e))return null}catch(t){}return t.toString("utf8",0,t.length)},_readUInt:function(t){return 2===t.length?t.readUInt16BE(0):0x100000000*t.readUInt32BE(0)+t.readUInt32BE(4)}};for(var d in l)u.prototype[d]=l[d];t.exports=u},function(t,e,r){"use strict";var s=function(t){this._bufferSize=t,this.clear()};s.prototype.clear=function(){this._buffer=Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0},s.prototype.push=function(t){var e=!1,r=!1;this._ringSize<this._bufferSize?e=0===this._tail:this._ringOffset===this._ringSize&&(e=!0,r=0===this._tail),e&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(Array(this._bufferSize)),this._bufferSize=this._buffer.length,r&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=t,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize},s.prototype.peek=function(){if(0!==this.length)return this._buffer[this._head]},s.prototype.shift=function(){if(0!==this.length){var t=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,0===this._ringOffset&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,t}},t.exports=s},function(t,e,r){"use strict";var s=r(13),n=function(){this._complete=!1,this._callbacks=new s(n.QUEUE_SIZE)};n.QUEUE_SIZE=4,n.all=function(t){var e=new n,r=t.length,s=r;for(0===r&&e.done();s--;)t[s].then(function(){0==(r-=1)&&e.done()});return e},n.prototype.then=function(t){this._complete?t():this._callbacks.push(t)},n.prototype.done=function(){this._complete=!0;for(var t,e=this._callbacks;t=e.shift();)t()},t.exports=n},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(2),i=r(0),o=function(t,e,r){n.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};i.inherits(o,n);var a={close:function(){return 3!==this.readyState&&(this.readyState=3,this.emit("close",new n.CloseEvent(null,null)),!0)},parse:function(t){this.readyState>1||(this._reader.put(t),this._reader.eachByte(function(t){var e;switch(this._stage){case -1:this._body.push(t),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(t);break;case 1:if(this._length=(127&t)+128*this._length,this._closing&&0===this._length)return this.close();(128&t)!=128&&(0===this._length?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(255===t)this._stage=0,e=s.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new n.MessageEvent(e));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(t),this._buffer.length>this._maxLength)return this.close()}},this))},frame:function(t){if(0===this.readyState)return this._queue([t]);if(this.readyState>1)return!1;"string"!=typeof t&&(t=t.toString());var e=s.byteLength(t),r=s.allocUnsafe(e+2);return r[0]=0,r.write(t,1),r[r.length-1]=255,this._write(r),!0},_handshakeResponse:function(){var t=["HTTP/1.1 101 Web Socket Protocol Handshake",this._headers.toString(),""];return s.from(t.join("\r\n"),"utf8")},_parseLeadingByte:function(t){(128&t)==128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(var h in a)o.prototype[h]=a[h];t.exports=o},function(t,e,r){"use strict";var s=r(7);t.exports={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,r){this.on(t,e)},removeEventListener:function(t,e,r){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=s.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s="utf8: invalid string",n="utf8: invalid source encoding";function i(t){for(var e=0,r=0;r<t.length;r++){var n=t.charCodeAt(r);if(n<128)e+=1;else if(n<2048)e+=2;else if(n<55296)e+=3;else if(n<=57343){if(r>=t.length-1)throw Error(s);r++,e+=4}else throw Error(s)}return e}e.encode=function(t){for(var e=new Uint8Array(i(t)),r=0,s=0;s<t.length;s++){var n=t.charCodeAt(s);n<128?e[r++]=n:(n<2048?e[r++]=192|n>>6:(n<55296?e[r++]=224|n>>12:(s++,n=((1023&n)<<10|1023&t.charCodeAt(s))+65536,e[r++]=240|n>>18,e[r++]=128|n>>12&63),e[r++]=128|n>>6&63),e[r++]=128|63&n)}return e},e.encodedLength=i,e.decode=function(t){for(var e=[],r=0;r<t.length;r++){var s=t[r];if(128&s){var i=void 0;if(s<224){if(r>=t.length)throw Error(n);var o=t[++r];if((192&o)!=128)throw Error(n);s=(31&s)<<6|63&o,i=128}else if(s<240){if(r>=t.length-1)throw Error(n);var o=t[++r],a=t[++r];if((192&o)!=128||(192&a)!=128)throw Error(n);s=(15&s)<<12|(63&o)<<6|63&a,i=2048}else if(s<248){if(r>=t.length-2)throw Error(n);var o=t[++r],a=t[++r],h=t[++r];if((192&o)!=128||(192&a)!=128||(192&h)!=128)throw Error(n);s=(15&s)<<18|(63&o)<<12|(63&a)<<6|63&h,i=65536}else throw Error(n);if(s<i||s>=55296&&s<=57343)throw Error(n);if(s>=65536){if(s>1114111)throw Error(n);s-=65536,e.push(String.fromCharCode(55296|s>>10)),s=56320|1023&s}}e.push(String.fromCharCode(s))}return e.join("")}},function(t,e,r){"use strict";var s=r(0),n=r(4),i=r(11),o=function(t,e,r,s,o){o=o||{},this._stream=e,this._driver=n.http(t,{maxLength:o.maxLength,protocols:s});var a=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var h=function(){a._stream.removeListener("data",h)};this._stream.on("data",h),i.call(this,o),process.nextTick(function(){a._driver.start(),a._driver.io.write(r)})}};s.inherits(o,i),o.isWebSocket=function(t){return n.isWebSocket(t)},o.validateOptions=function(t,e){n.validateOptions(t,e)},o.WebSocket=o,o.Client=r(39),o.EventSource=r(42),t.exports=o},function(t,e,r){var s=r(6),n=r(43).spawn,i=r(44);e.XMLHttpRequest=function(){"use strict";var t,e,o=this,a=r(45),h=r(46),c={},u=!1,l={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},d={},f={},p=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],g=["TRACE","TRACK","CONNECT"],_=!1,v=!1,m={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1,this.open=function(t,e,r,s,n){if(this.abort(),v=!1,!(t&&-1===g.indexOf(t)))throw Error("SecurityError: Request method not allowed");c={method:t,url:e.toString(),async:"boolean"!=typeof r||r,user:s||null,password:n||null},b(this.OPENED)},this.setDisableHeaderCheck=function(t){u=t},this.setRequestHeader=function(t,e){var r;if(this.readyState!==this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(r=t,!u&&(!r||-1!==p.indexOf(r.toLowerCase()))){console.warn('Refused to set unsafe header "'+t+'"');return}if(_)throw Error("INVALID_STATE_ERR: send flag is true");t=f[t.toLowerCase()]||t,f[t.toLowerCase()]=t,d[t]=d[t]?d[t]+", "+e:e},this.getResponseHeader=function(t){return"string"==typeof t&&this.readyState>this.OPENED&&e&&e.headers&&e.headers[t.toLowerCase()]&&!v?e.headers[t.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||v)return"";var t="";for(var r in e.headers)"set-cookie"!==r&&"set-cookie2"!==r&&(t+=r+": "+e.headers[r]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(t){return"string"==typeof t&&f[t.toLowerCase()]?d[f[t.toLowerCase()]]:""},this.send=function(r){if(this.readyState!==this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(_)throw Error("INVALID_STATE_ERR: send has already been called");var u,p=!1,g=!1,m=s.parse(c.url);switch(m.protocol){case"https:":p=!0;case"http:":u=m.hostname;break;case"file:":g=!0;break;case void 0:case null:case"":u="localhost";break;default:throw Error("Protocol not supported.")}if(g){if("GET"!==c.method)throw Error("XMLHttpRequest: Only GET method is supported");if(c.async)i.readFile(m.pathname,"utf8",function(t,e){t?o.handleError(t):(o.status=200,o.responseText=e,b(o.DONE))});else try{this.responseText=i.readFileSync(m.pathname,"utf8"),this.status=200,b(o.DONE)}catch(t){this.handleError(t)}return}var y=m.port||(p?443:80),x=m.pathname+(m.search?m.search:"");for(var S in l)f[S.toLowerCase()]||(d[S]=l[S]);if(d.Host=u,p&&443===y||80===y||(d.Host+=":"+m.port),c.user){void 0===c.password&&(c.password="");var E=new Buffer(c.user+":"+c.password);d.Authorization="Basic "+E.toString("base64")}"GET"===c.method||"HEAD"===c.method?r=null:r?(d["Content-Length"]=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),d["Content-Type"]||(d["Content-Type"]="text/plain;charset=UTF-8")):"POST"===c.method&&(d["Content-Length"]=0);var w={host:u,port:y,path:x,method:c.method,headers:d,agent:!1,withCredentials:o.withCredentials};if(v=!1,c.async){var C=p?h.request:a.request;_=!0,o.dispatchEvent("readystatechange");var k=function(t){o.handleError(t)};t=C(w,function r(n){if(301===(e=n).statusCode||302===e.statusCode||303===e.statusCode||307===e.statusCode){c.url=e.headers.location;var i=s.parse(c.url);u=i.hostname,(t=C({hostname:i.hostname,port:i.port,path:i.path,method:303===e.statusCode?"GET":c.method,headers:d,withCredentials:o.withCredentials},r).on("error",k)).end();return}e.setEncoding("utf8"),b(o.HEADERS_RECEIVED),o.status=e.statusCode,e.on("data",function(t){t&&(o.responseText+=t),_&&b(o.LOADING)}),e.on("end",function(){_&&(b(o.DONE),_=!1)}),e.on("error",function(t){o.handleError(t)})}).on("error",k),r&&t.write(r),t.end(),o.dispatchEvent("loadstart")}else{var O=".node-xmlhttprequest-content-"+process.pid,T=".node-xmlhttprequest-sync-"+process.pid;i.writeFileSync(T,"","utf8");for(var P="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(p?"s":"")+".request;var options = "+JSON.stringify(w)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+O+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+T+"');});response.on('error', function(error) {fs.writeFileSync('"+O+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+T+"');});}).on('error', function(error) {fs.writeFileSync('"+O+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+T+"');});"+(r?"req.write('"+JSON.stringify(r).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",A=n(process.argv[0],["-e",P]);i.existsSync(T););var R=JSON.parse(i.readFileSync(O,"utf8"));A.stdin.end(),i.unlinkSync(O),R.err?o.handleError(R.err):(e=R.data,o.status=R.data.statusCode,o.responseText=R.data.text,b(o.DONE))}},this.handleError=function(t){this.status=0,this.statusText=t,this.responseText=t.stack,v=!0,b(this.DONE),this.dispatchEvent("error")},this.abort=function(){t&&(t.abort(),t=null),d=l,this.status=0,this.responseText="",this.responseXML="",v=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||_)&&this.readyState!==this.DONE&&(_=!1,b(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(t,e){t in m||(m[t]=[]),m[t].push(e)},this.removeEventListener=function(t,e){t in m&&(m[t]=m[t].filter(function(t){return t!==e}))},this.dispatchEvent=function(t){if("function"==typeof o["on"+t]&&o["on"+t](),t in m)for(var e=0,r=m[t].length;e<r;e++)m[t][e].call(o)};var b=function(t){t!=o.LOADING&&o.readyState===t||(o.readyState=t,(c.async||o.readyState<o.OPENED||o.readyState===o.DONE)&&o.dispatchEvent("readystatechange"),o.readyState!==o.DONE||v||(o.dispatchEvent("load"),o.dispatchEvent("loadend")))}}},function(t,e,r){!function(t){"use strict";var e,s=function(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;e++)r[e]=t[e];return r},n=function(){throw Error("no PRNG")},i=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var a=s(),h=s([1]),c=s([56129,1]),u=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(t,e,r,s){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r,t[e+4]=s>>24&255,t[e+5]=s>>16&255,t[e+6]=s>>8&255,t[e+7]=255&s}function _(t,e,r,s,n){var i,o=0;for(i=0;i<n;i++)o|=t[e+i]^r[s+i];return(1&o-1>>>8)-1}function v(t,e,r,s){return _(t,e,r,s,16)}function m(t,e,r,s){return _(t,e,r,s,32)}function b(t,e,r,s){!function(t,e,r,s){for(var n,i=255&s[0]|(255&s[1])<<8|(255&s[2])<<16|(255&s[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&s[4]|(255&s[5])<<8|(255&s[6])<<16|(255&s[7])<<24,l=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,d=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,f=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,p=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,g=255&s[8]|(255&s[9])<<8|(255&s[10])<<16|(255&s[11])<<24,_=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,y=255&s[12]|(255&s[13])<<8|(255&s[14])<<16|(255&s[15])<<24,x=i,S=o,E=a,w=h,C=c,k=u,O=l,T=d,P=f,A=p,R=g,N=_,L=v,U=m,D=b,I=y,M=0;M<20;M+=2)C^=(n=x+L|0)<<7|n>>>25,P^=(n=C+x|0)<<9|n>>>23,L^=(n=P+C|0)<<13|n>>>19,x^=(n=L+P|0)<<18|n>>>14,A^=(n=k+S|0)<<7|n>>>25,U^=(n=A+k|0)<<9|n>>>23,S^=(n=U+A|0)<<13|n>>>19,k^=(n=S+U|0)<<18|n>>>14,D^=(n=R+O|0)<<7|n>>>25,E^=(n=D+R|0)<<9|n>>>23,O^=(n=E+D|0)<<13|n>>>19,R^=(n=O+E|0)<<18|n>>>14,w^=(n=I+N|0)<<7|n>>>25,T^=(n=w+I|0)<<9|n>>>23,N^=(n=T+w|0)<<13|n>>>19,I^=(n=N+T|0)<<18|n>>>14,S^=(n=x+w|0)<<7|n>>>25,E^=(n=S+x|0)<<9|n>>>23,w^=(n=E+S|0)<<13|n>>>19,x^=(n=w+E|0)<<18|n>>>14,O^=(n=k+C|0)<<7|n>>>25,T^=(n=O+k|0)<<9|n>>>23,C^=(n=T+O|0)<<13|n>>>19,k^=(n=C+T|0)<<18|n>>>14,N^=(n=R+A|0)<<7|n>>>25,P^=(n=N+R|0)<<9|n>>>23,A^=(n=P+N|0)<<13|n>>>19,R^=(n=A+P|0)<<18|n>>>14,L^=(n=I+D|0)<<7|n>>>25,U^=(n=L+I|0)<<9|n>>>23,D^=(n=U+L|0)<<13|n>>>19,I^=(n=D+U|0)<<18|n>>>14;x=x+i|0,S=S+o|0,E=E+a|0,w=w+h|0,C=C+c|0,k=k+u|0,O=O+l|0,T=T+d|0,P=P+f|0,A=A+p|0,R=R+g|0,N=N+_|0,L=L+v|0,U=U+m|0,D=D+b|0,I=I+y|0,t[0]=x>>>0&255,t[1]=x>>>8&255,t[2]=x>>>16&255,t[3]=x>>>24&255,t[4]=S>>>0&255,t[5]=S>>>8&255,t[6]=S>>>16&255,t[7]=S>>>24&255,t[8]=E>>>0&255,t[9]=E>>>8&255,t[10]=E>>>16&255,t[11]=E>>>24&255,t[12]=w>>>0&255,t[13]=w>>>8&255,t[14]=w>>>16&255,t[15]=w>>>24&255,t[16]=C>>>0&255,t[17]=C>>>8&255,t[18]=C>>>16&255,t[19]=C>>>24&255,t[20]=k>>>0&255,t[21]=k>>>8&255,t[22]=k>>>16&255,t[23]=k>>>24&255,t[24]=O>>>0&255,t[25]=O>>>8&255,t[26]=O>>>16&255,t[27]=O>>>24&255,t[28]=T>>>0&255,t[29]=T>>>8&255,t[30]=T>>>16&255,t[31]=T>>>24&255,t[32]=P>>>0&255,t[33]=P>>>8&255,t[34]=P>>>16&255,t[35]=P>>>24&255,t[36]=A>>>0&255,t[37]=A>>>8&255,t[38]=A>>>16&255,t[39]=A>>>24&255,t[40]=R>>>0&255,t[41]=R>>>8&255,t[42]=R>>>16&255,t[43]=R>>>24&255,t[44]=N>>>0&255,t[45]=N>>>8&255,t[46]=N>>>16&255,t[47]=N>>>24&255,t[48]=L>>>0&255,t[49]=L>>>8&255,t[50]=L>>>16&255,t[51]=L>>>24&255,t[52]=U>>>0&255,t[53]=U>>>8&255,t[54]=U>>>16&255,t[55]=U>>>24&255,t[56]=D>>>0&255,t[57]=D>>>8&255,t[58]=D>>>16&255,t[59]=D>>>24&255,t[60]=I>>>0&255,t[61]=I>>>8&255,t[62]=I>>>16&255,t[63]=I>>>24&255}(t,e,r,s)}function y(t,e,r,s){!function(t,e,r,s){for(var n,i=255&s[0]|(255&s[1])<<8|(255&s[2])<<16|(255&s[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&s[4]|(255&s[5])<<8|(255&s[6])<<16|(255&s[7])<<24,l=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,d=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,f=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,p=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,g=255&s[8]|(255&s[9])<<8|(255&s[10])<<16|(255&s[11])<<24,_=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,y=255&s[12]|(255&s[13])<<8|(255&s[14])<<16|(255&s[15])<<24,x=i,S=o,E=a,w=h,C=c,k=u,O=l,T=d,P=f,A=p,R=g,N=_,L=v,U=m,D=b,I=y,M=0;M<20;M+=2)C^=(n=x+L|0)<<7|n>>>25,P^=(n=C+x|0)<<9|n>>>23,L^=(n=P+C|0)<<13|n>>>19,x^=(n=L+P|0)<<18|n>>>14,A^=(n=k+S|0)<<7|n>>>25,U^=(n=A+k|0)<<9|n>>>23,S^=(n=U+A|0)<<13|n>>>19,k^=(n=S+U|0)<<18|n>>>14,D^=(n=R+O|0)<<7|n>>>25,E^=(n=D+R|0)<<9|n>>>23,O^=(n=E+D|0)<<13|n>>>19,R^=(n=O+E|0)<<18|n>>>14,w^=(n=I+N|0)<<7|n>>>25,T^=(n=w+I|0)<<9|n>>>23,N^=(n=T+w|0)<<13|n>>>19,I^=(n=N+T|0)<<18|n>>>14,S^=(n=x+w|0)<<7|n>>>25,E^=(n=S+x|0)<<9|n>>>23,w^=(n=E+S|0)<<13|n>>>19,x^=(n=w+E|0)<<18|n>>>14,O^=(n=k+C|0)<<7|n>>>25,T^=(n=O+k|0)<<9|n>>>23,C^=(n=T+O|0)<<13|n>>>19,k^=(n=C+T|0)<<18|n>>>14,N^=(n=R+A|0)<<7|n>>>25,P^=(n=N+R|0)<<9|n>>>23,A^=(n=P+N|0)<<13|n>>>19,R^=(n=A+P|0)<<18|n>>>14,L^=(n=I+D|0)<<7|n>>>25,U^=(n=L+I|0)<<9|n>>>23,D^=(n=U+L|0)<<13|n>>>19,I^=(n=D+U|0)<<18|n>>>14;t[0]=x>>>0&255,t[1]=x>>>8&255,t[2]=x>>>16&255,t[3]=x>>>24&255,t[4]=k>>>0&255,t[5]=k>>>8&255,t[6]=k>>>16&255,t[7]=k>>>24&255,t[8]=R>>>0&255,t[9]=R>>>8&255,t[10]=R>>>16&255,t[11]=R>>>24&255,t[12]=I>>>0&255,t[13]=I>>>8&255,t[14]=I>>>16&255,t[15]=I>>>24&255,t[16]=O>>>0&255,t[17]=O>>>8&255,t[18]=O>>>16&255,t[19]=O>>>24&255,t[20]=T>>>0&255,t[21]=T>>>8&255,t[22]=T>>>16&255,t[23]=T>>>24&255,t[24]=P>>>0&255,t[25]=P>>>8&255,t[26]=P>>>16&255,t[27]=P>>>24&255,t[28]=A>>>0&255,t[29]=A>>>8&255,t[30]=A>>>16&255,t[31]=A>>>24&255}(t,e,r,s)}var x=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function S(t,e,r,s,n,i,o){var a,h,c=new Uint8Array(16),u=new Uint8Array(64);for(h=0;h<16;h++)c[h]=0;for(h=0;h<8;h++)c[h]=i[h];for(;n>=64;){for(b(u,c,o,x),h=0;h<64;h++)t[e+h]=r[s+h]^u[h];for(h=8,a=1;h<16;h++)a=a+(255&c[h])|0,c[h]=255&a,a>>>=8;n-=64,e+=64,s+=64}if(n>0)for(b(u,c,o,x),h=0;h<n;h++)t[e+h]=r[s+h]^u[h];return 0}function E(t,e,r,s,n){var i,o,a=new Uint8Array(16),h=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=s[o];for(;r>=64;){for(b(h,a,n,x),o=0;o<64;o++)t[e+o]=h[o];for(o=8,i=1;o<16;o++)i=i+(255&a[o])|0,a[o]=255&i,i>>>=8;r-=64,e+=64}if(r>0)for(b(h,a,n,x),o=0;o<r;o++)t[e+o]=h[o];return 0}function w(t,e,r,s,n){var i=new Uint8Array(32);y(i,s,n,x);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=s[a+16];return E(t,e,r,o,i)}function C(t,e,r,s,n,i,o){var a=new Uint8Array(32);y(a,i,o,x);for(var h=new Uint8Array(8),c=0;c<8;c++)h[c]=i[c+16];return S(t,e,r,s,n,h,a)}var k=function(t){var e,r,s,n,i,o,a,h;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,e=255&t[0]|(255&t[1])<<8,this.r[0]=8191&e,r=255&t[2]|(255&t[3])<<8,this.r[1]=(e>>>13|r<<3)&8191,s=255&t[4]|(255&t[5])<<8,this.r[2]=(r>>>10|s<<6)&7939,n=255&t[6]|(255&t[7])<<8,this.r[3]=(s>>>7|n<<9)&8191,i=255&t[8]|(255&t[9])<<8,this.r[4]=(n>>>4|i<<12)&255,this.r[5]=i>>>1&8190,o=255&t[10]|(255&t[11])<<8,this.r[6]=(i>>>14|o<<2)&8191,a=255&t[12]|(255&t[13])<<8,this.r[7]=(o>>>11|a<<5)&8065,h=255&t[14]|(255&t[15])<<8,this.r[8]=(a>>>8|h<<8)&8191,this.r[9]=h>>>5&127,this.pad[0]=255&t[16]|(255&t[17])<<8,this.pad[1]=255&t[18]|(255&t[19])<<8,this.pad[2]=255&t[20]|(255&t[21])<<8,this.pad[3]=255&t[22]|(255&t[23])<<8,this.pad[4]=255&t[24]|(255&t[25])<<8,this.pad[5]=255&t[26]|(255&t[27])<<8,this.pad[6]=255&t[28]|(255&t[29])<<8,this.pad[7]=255&t[30]|(255&t[31])<<8};function O(t,e,r,s,n,i){var o=new k(i);return o.update(r,s,n),o.finish(t,e),0}function T(t,e,r,s,n,i){var o=new Uint8Array(16);return O(o,0,r,s,n,i),v(t,e,o,0)}function P(t,e,r,s,n){var i;if(r<32)return -1;for(C(t,0,e,0,r,s,n),O(t,16,t,32,r-32,t),i=0;i<16;i++)t[i]=0;return 0}function A(t,e,r,s,n){var i,o=new Uint8Array(32);if(r<32||(w(o,0,32,s,n),0!==T(e,16,e,32,r-32,o)))return -1;for(C(t,0,e,0,r,s,n),i=0;i<32;i++)t[i]=0;return 0}function R(t,e){var r;for(r=0;r<16;r++)t[r]=0|e[r]}function N(t){var e,r,s=1;for(e=0;e<16;e++)s=Math.floor((r=t[e]+s+65535)/65536),t[e]=r-65536*s;t[0]+=s-1+37*(s-1)}function L(t,e,r){for(var s,n=~(r-1),i=0;i<16;i++)s=n&(t[i]^e[i]),t[i]^=s,e[i]^=s}function U(t,e){var r,n,i,o=s(),a=s();for(r=0;r<16;r++)a[r]=e[r];for(N(a),N(a),N(a),n=0;n<2;n++){for(r=1,o[0]=a[0]-65517;r<15;r++)o[r]=a[r]-65535-(o[r-1]>>16&1),o[r-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),i=o[15]>>16&1,o[14]&=65535,L(a,o,1-i)}for(r=0;r<16;r++)t[2*r]=255&a[r],t[2*r+1]=a[r]>>8}function D(t,e){var r=new Uint8Array(32),s=new Uint8Array(32);return U(r,t),U(s,e),m(r,0,s,0)}function I(t){var e=new Uint8Array(32);return U(e,t),1&e[0]}function M(t,e){var r;for(r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function H(t,e,r){for(var s=0;s<16;s++)t[s]=e[s]+r[s]}function B(t,e,r){for(var s=0;s<16;s++)t[s]=e[s]-r[s]}function q(t,e,r){var s,n,i=0,o=0,a=0,h=0,c=0,u=0,l=0,d=0,f=0,p=0,g=0,_=0,v=0,m=0,b=0,y=0,x=0,S=0,E=0,w=0,C=0,k=0,O=0,T=0,P=0,A=0,R=0,N=0,L=0,U=0,D=0,I=r[0],M=r[1],H=r[2],B=r[3],q=r[4],j=r[5],z=r[6],F=r[7],K=r[8],G=r[9],Y=r[10],W=r[11],V=r[12],$=r[13],X=r[14],J=r[15];i+=(s=e[0])*I,o+=s*M,a+=s*H,h+=s*B,c+=s*q,u+=s*j,l+=s*z,d+=s*F,f+=s*K,p+=s*G,g+=s*Y,_+=s*W,v+=s*V,m+=s*$,b+=s*X,y+=s*J,o+=(s=e[1])*I,a+=s*M,h+=s*H,c+=s*B,u+=s*q,l+=s*j,d+=s*z,f+=s*F,p+=s*K,g+=s*G,_+=s*Y,v+=s*W,m+=s*V,b+=s*$,y+=s*X,x+=s*J,a+=(s=e[2])*I,h+=s*M,c+=s*H,u+=s*B,l+=s*q,d+=s*j,f+=s*z,p+=s*F,g+=s*K,_+=s*G,v+=s*Y,m+=s*W,b+=s*V,y+=s*$,x+=s*X,S+=s*J,h+=(s=e[3])*I,c+=s*M,u+=s*H,l+=s*B,d+=s*q,f+=s*j,p+=s*z,g+=s*F,_+=s*K,v+=s*G,m+=s*Y,b+=s*W,y+=s*V,x+=s*$,S+=s*X,E+=s*J,c+=(s=e[4])*I,u+=s*M,l+=s*H,d+=s*B,f+=s*q,p+=s*j,g+=s*z,_+=s*F,v+=s*K,m+=s*G,b+=s*Y,y+=s*W,x+=s*V,S+=s*$,E+=s*X,w+=s*J,u+=(s=e[5])*I,l+=s*M,d+=s*H,f+=s*B,p+=s*q,g+=s*j,_+=s*z,v+=s*F,m+=s*K,b+=s*G,y+=s*Y,x+=s*W,S+=s*V,E+=s*$,w+=s*X,C+=s*J,l+=(s=e[6])*I,d+=s*M,f+=s*H,p+=s*B,g+=s*q,_+=s*j,v+=s*z,m+=s*F,b+=s*K,y+=s*G,x+=s*Y,S+=s*W,E+=s*V,w+=s*$,C+=s*X,k+=s*J,d+=(s=e[7])*I,f+=s*M,p+=s*H,g+=s*B,_+=s*q,v+=s*j,m+=s*z,b+=s*F,y+=s*K,x+=s*G,S+=s*Y,E+=s*W,w+=s*V,C+=s*$,k+=s*X,O+=s*J,f+=(s=e[8])*I,p+=s*M,g+=s*H,_+=s*B,v+=s*q,m+=s*j,b+=s*z,y+=s*F,x+=s*K,S+=s*G,E+=s*Y,w+=s*W,C+=s*V,k+=s*$,O+=s*X,T+=s*J,p+=(s=e[9])*I,g+=s*M,_+=s*H,v+=s*B,m+=s*q,b+=s*j,y+=s*z,x+=s*F,S+=s*K,E+=s*G,w+=s*Y,C+=s*W,k+=s*V,O+=s*$,T+=s*X,P+=s*J,g+=(s=e[10])*I,_+=s*M,v+=s*H,m+=s*B,b+=s*q,y+=s*j,x+=s*z,S+=s*F,E+=s*K,w+=s*G,C+=s*Y,k+=s*W,O+=s*V,T+=s*$,P+=s*X,A+=s*J,_+=(s=e[11])*I,v+=s*M,m+=s*H,b+=s*B,y+=s*q,x+=s*j,S+=s*z,E+=s*F,w+=s*K,C+=s*G,k+=s*Y,O+=s*W,T+=s*V,P+=s*$,A+=s*X,R+=s*J,v+=(s=e[12])*I,m+=s*M,b+=s*H,y+=s*B,x+=s*q,S+=s*j,E+=s*z,w+=s*F,C+=s*K,k+=s*G,O+=s*Y,T+=s*W,P+=s*V,A+=s*$,R+=s*X,N+=s*J,m+=(s=e[13])*I,b+=s*M,y+=s*H,x+=s*B,S+=s*q,E+=s*j,w+=s*z,C+=s*F,k+=s*K,O+=s*G,T+=s*Y,P+=s*W,A+=s*V,R+=s*$,N+=s*X,L+=s*J,b+=(s=e[14])*I,y+=s*M,x+=s*H,S+=s*B,E+=s*q,w+=s*j,C+=s*z,k+=s*F,O+=s*K,T+=s*G,P+=s*Y,A+=s*W,R+=s*V,N+=s*$,L+=s*X,U+=s*J,y+=(s=e[15])*I,x+=s*M,S+=s*H,E+=s*B,w+=s*q,C+=s*j,k+=s*z,O+=s*F,T+=s*K,P+=s*G,A+=s*Y,R+=s*W,N+=s*V,L+=s*$,U+=s*X,D+=s*J,i+=38*x,o+=38*S,a+=38*E,h+=38*w,c+=38*C,u+=38*k,l+=38*O,d+=38*T,f+=38*P,p+=38*A,g+=38*R,_+=38*N,v+=38*L,m+=38*U,b+=38*D,n=Math.floor((s=i+(n=1)+65535)/65536),i=s-65536*n,n=Math.floor((s=o+n+65535)/65536),o=s-65536*n,n=Math.floor((s=a+n+65535)/65536),a=s-65536*n,n=Math.floor((s=h+n+65535)/65536),h=s-65536*n,n=Math.floor((s=c+n+65535)/65536),c=s-65536*n,n=Math.floor((s=u+n+65535)/65536),u=s-65536*n,n=Math.floor((s=l+n+65535)/65536),l=s-65536*n,n=Math.floor((s=d+n+65535)/65536),d=s-65536*n,n=Math.floor((s=f+n+65535)/65536),f=s-65536*n,n=Math.floor((s=p+n+65535)/65536),p=s-65536*n,n=Math.floor((s=g+n+65535)/65536),g=s-65536*n,n=Math.floor((s=_+n+65535)/65536),_=s-65536*n,n=Math.floor((s=v+n+65535)/65536),v=s-65536*n,n=Math.floor((s=m+n+65535)/65536),m=s-65536*n,n=Math.floor((s=b+n+65535)/65536),b=s-65536*n,n=Math.floor((s=y+n+65535)/65536),y=s-65536*n,i+=n-1+37*(n-1),n=Math.floor((s=i+(n=1)+65535)/65536),i=s-65536*n,n=Math.floor((s=o+n+65535)/65536),o=s-65536*n,n=Math.floor((s=a+n+65535)/65536),a=s-65536*n,n=Math.floor((s=h+n+65535)/65536),h=s-65536*n,n=Math.floor((s=c+n+65535)/65536),c=s-65536*n,n=Math.floor((s=u+n+65535)/65536),u=s-65536*n,n=Math.floor((s=l+n+65535)/65536),l=s-65536*n,n=Math.floor((s=d+n+65535)/65536),d=s-65536*n,n=Math.floor((s=f+n+65535)/65536),f=s-65536*n,n=Math.floor((s=p+n+65535)/65536),p=s-65536*n,n=Math.floor((s=g+n+65535)/65536),g=s-65536*n,n=Math.floor((s=_+n+65535)/65536),_=s-65536*n,n=Math.floor((s=v+n+65535)/65536),v=s-65536*n,n=Math.floor((s=m+n+65535)/65536),m=s-65536*n,n=Math.floor((s=b+n+65535)/65536),b=s-65536*n,n=Math.floor((s=y+n+65535)/65536),y=s-65536*n,i+=n-1+37*(n-1),t[0]=i,t[1]=o,t[2]=a,t[3]=h,t[4]=c,t[5]=u,t[6]=l,t[7]=d,t[8]=f,t[9]=p,t[10]=g,t[11]=_,t[12]=v,t[13]=m,t[14]=b,t[15]=y}function j(t,e){q(t,e,e)}function z(t,e){var r,n=s();for(r=0;r<16;r++)n[r]=e[r];for(r=253;r>=0;r--)j(n,n),2!==r&&4!==r&&q(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}function F(t,e){var r,n=s();for(r=0;r<16;r++)n[r]=e[r];for(r=250;r>=0;r--)j(n,n),1!==r&&q(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}function K(t,e,r){var n,i,o=new Uint8Array(32),a=new Float64Array(80),h=s(),u=s(),l=s(),d=s(),f=s(),p=s();for(i=0;i<31;i++)o[i]=e[i];for(o[31]=127&e[31]|64,o[0]&=248,M(a,r),i=0;i<16;i++)u[i]=a[i],d[i]=h[i]=l[i]=0;for(i=254,h[0]=d[0]=1;i>=0;--i)L(h,u,n=o[i>>>3]>>>(7&i)&1),L(l,d,n),H(f,h,l),B(h,h,l),H(l,u,d),B(u,u,d),j(d,f),j(p,h),q(h,l,h),q(l,u,f),H(f,h,l),B(h,h,l),j(u,h),B(l,d,p),q(h,l,c),H(h,h,d),q(l,l,h),q(h,d,p),q(d,u,a),j(u,f),L(h,u,n),L(l,d,n);for(i=0;i<16;i++)a[i+16]=h[i],a[i+32]=l[i],a[i+48]=u[i],a[i+64]=d[i];var g=a.subarray(32),_=a.subarray(16);return z(g,g),q(_,_,g),U(t,_),0}function G(t,e){return K(t,e,o)}function Y(t,e){return n(e,32),G(t,e)}function W(t,e,r){var s=new Uint8Array(32);return K(s,r,e),y(t,i,s,x)}k.prototype.blocks=function(t,e,r){for(var s,n,i,o,a,h,c,u,l,d,f,p,g,_,v,m,b,y,x,S=this.fin?0:2048,E=this.h[0],w=this.h[1],C=this.h[2],k=this.h[3],O=this.h[4],T=this.h[5],P=this.h[6],A=this.h[7],R=this.h[8],N=this.h[9],L=this.r[0],U=this.r[1],D=this.r[2],I=this.r[3],M=this.r[4],H=this.r[5],B=this.r[6],q=this.r[7],j=this.r[8],z=this.r[9];r>=16;)E+=8191&(s=255&t[e+0]|(255&t[e+1])<<8),w+=(s>>>13|(n=255&t[e+2]|(255&t[e+3])<<8)<<3)&8191,C+=(n>>>10|(i=255&t[e+4]|(255&t[e+5])<<8)<<6)&8191,k+=(i>>>7|(o=255&t[e+6]|(255&t[e+7])<<8)<<9)&8191,O+=(o>>>4|(a=255&t[e+8]|(255&t[e+9])<<8)<<12)&8191,T+=a>>>1&8191,P+=(a>>>14|(h=255&t[e+10]|(255&t[e+11])<<8)<<2)&8191,A+=(h>>>11|(c=255&t[e+12]|(255&t[e+13])<<8)<<5)&8191,R+=(c>>>8|(u=255&t[e+14]|(255&t[e+15])<<8)<<8)&8191,N+=u>>>5|S,l=(d=(l=0)+E*L+5*z*w+5*j*C+5*q*k+5*B*O)>>>13,d&=8191,d+=5*H*T+5*M*P+5*I*A+5*D*R+5*U*N,l+=d>>>13,d&=8191,l=(f=l+E*U+w*L+5*z*C+5*j*k+5*q*O)>>>13,f&=8191,f+=5*B*T,f+=5*H*P,f+=5*M*A,f+=5*I*R,f+=5*D*N,l+=f>>>13,f&=8191,l=(p=l+E*D+w*U+C*L+5*z*k+5*j*O)>>>13,p&=8191,p+=5*q*T,p+=5*B*P,p+=5*H*A,p+=5*M*R,p+=5*I*N,l+=p>>>13,p&=8191,l=(g=l+E*I+w*D+C*U+k*L+5*z*O)>>>13,g&=8191,g+=5*j*T,g+=5*q*P,g+=5*B*A,g+=5*H*R,g+=5*M*N,l+=g>>>13,g&=8191,l=(_=l+E*M+w*I+C*D+k*U+O*L)>>>13,_&=8191,_+=5*z*T,_+=5*j*P,_+=5*q*A,_+=5*B*R,_+=5*H*N,l+=_>>>13,_&=8191,l=(v=l+E*H+w*M+C*I+k*D+O*U)>>>13,v&=8191,v+=T*L,v+=5*z*P,v+=5*j*A,v+=5*q*R,v+=5*B*N,l+=v>>>13,v&=8191,l=(m=l+E*B+w*H+C*M+k*I+O*D)>>>13,m&=8191,m+=T*U,m+=P*L,m+=5*z*A,m+=5*j*R,m+=5*q*N,l+=m>>>13,m&=8191,l=(b=l+E*q+w*B+C*H+k*M+O*I)>>>13,b&=8191,b+=T*D,b+=P*U,b+=A*L,b+=5*z*R,b+=5*j*N,l+=b>>>13,b&=8191,l=(y=l+E*j+w*q+C*B+k*H+O*M)>>>13,y&=8191,y+=T*I,y+=P*D,y+=A*U,y+=R*L,y+=5*z*N,l+=y>>>13,y&=8191,l=(x=l+E*z+w*j+C*q+k*B+O*H)>>>13,x&=8191,x+=T*M,x+=P*I,x+=A*D,x+=R*U,x+=N*L,l+=x>>>13,x&=8191,d=8191&(l=(l=(l<<2)+l|0)+d|0),l>>>=13,f+=l,E=d,w=f,C=p,k=g,O=_,T=v,P=m,A=b,R=y,N=x,e+=16,r-=16;this.h[0]=E,this.h[1]=w,this.h[2]=C,this.h[3]=k,this.h[4]=O,this.h[5]=T,this.h[6]=P,this.h[7]=A,this.h[8]=R,this.h[9]=N},k.prototype.finish=function(t,e){var r,s,n,i,o=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=r,r=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,i=1;i<10;i++)o[i]=this.h[i]+r,r=o[i]>>>13,o[i]&=8191;for(o[9]-=8192,s=(1^r)-1,i=0;i<10;i++)o[i]&=s;for(i=0,s=~s;i<10;i++)this.h[i]=this.h[i]&s|o[i];for(i=1,this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,n=this.h[0]+this.pad[0],this.h[0]=65535&n;i<8;i++)n=(this.h[i]+this.pad[i]|0)+(n>>>16)|0,this.h[i]=65535&n;t[e+0]=this.h[0]>>>0&255,t[e+1]=this.h[0]>>>8&255,t[e+2]=this.h[1]>>>0&255,t[e+3]=this.h[1]>>>8&255,t[e+4]=this.h[2]>>>0&255,t[e+5]=this.h[2]>>>8&255,t[e+6]=this.h[3]>>>0&255,t[e+7]=this.h[3]>>>8&255,t[e+8]=this.h[4]>>>0&255,t[e+9]=this.h[4]>>>8&255,t[e+10]=this.h[5]>>>0&255,t[e+11]=this.h[5]>>>8&255,t[e+12]=this.h[6]>>>0&255,t[e+13]=this.h[6]>>>8&255,t[e+14]=this.h[7]>>>0&255,t[e+15]=this.h[7]>>>8&255},k.prototype.update=function(t,e,r){var s,n;if(this.leftover){for((n=16-this.leftover)>r&&(n=r),s=0;s<n;s++)this.buffer[this.leftover+s]=t[e+s];if(r-=n,e+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(n=r-r%16,this.blocks(t,e,n),e+=n,r-=n),r){for(s=0;s<r;s++)this.buffer[this.leftover+s]=t[e+s];this.leftover+=r}};var V=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function $(t,e,r,s){for(var n,i,o,a,h,c,u,l,d,f,p,g,_,v,m,b,y,x,S,E,w,C,k,O,T,P,A=new Int32Array(16),R=new Int32Array(16),N=t[0],L=t[1],U=t[2],D=t[3],I=t[4],M=t[5],H=t[6],B=t[7],q=e[0],j=e[1],z=e[2],F=e[3],K=e[4],G=e[5],Y=e[6],W=e[7],$=0;s>=128;){for(S=0;S<16;S++)E=8*S+$,A[S]=r[E+0]<<24|r[E+1]<<16|r[E+2]<<8|r[E+3],R[S]=r[E+4]<<24|r[E+5]<<16|r[E+6]<<8|r[E+7];for(S=0;S<80;S++)if(n=N,i=L,o=U,a=D,h=I,c=M,u=H,l=B,d=q,f=j,p=z,g=F,_=K,v=G,m=Y,b=W,w=B,k=65535&(C=W),O=C>>>16,T=65535&w,P=w>>>16,w=(I>>>14|K<<18)^(I>>>18|K<<14)^(K>>>9|I<<23),k+=65535&(C=(K>>>14|I<<18)^(K>>>18|I<<14)^(I>>>9|K<<23)),O+=C>>>16,T+=65535&w,P+=w>>>16,w=I&M^~I&H,k+=65535&(C=K&G^~K&Y),O+=C>>>16,T+=65535&w,P+=w>>>16,w=V[2*S],k+=65535&(C=V[2*S+1]),O+=C>>>16,T+=65535&w,P+=w>>>16,w=A[S%16],k+=65535&(C=R[S%16]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,y=65535&T|P<<16,x=65535&k|O<<16,w=y,k=65535&(C=x),O=C>>>16,T=65535&w,P=w>>>16,w=(N>>>28|q<<4)^(q>>>2|N<<30)^(q>>>7|N<<25),k+=65535&(C=(q>>>28|N<<4)^(N>>>2|q<<30)^(N>>>7|q<<25)),O+=C>>>16,T+=65535&w,P+=w>>>16,w=N&L^N&U^L&U,k+=65535&(C=q&j^q&z^j&z),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,l=65535&T|P<<16,b=65535&k|O<<16,w=a,k=65535&(C=g),O=C>>>16,T=65535&w,P=w>>>16,w=y,k+=65535&(C=x),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,a=65535&T|P<<16,g=65535&k|O<<16,L=n,U=i,D=o,I=a,M=h,H=c,B=u,N=l,j=d,z=f,F=p,K=g,G=_,Y=v,W=m,q=b,S%16==15)for(E=0;E<16;E++)w=A[E],k=65535&(C=R[E]),O=C>>>16,T=65535&w,P=w>>>16,w=A[(E+9)%16],k+=65535&(C=R[(E+9)%16]),O+=C>>>16,T+=65535&w,P+=w>>>16,w=((y=A[(E+1)%16])>>>1|(x=R[(E+1)%16])<<31)^(y>>>8|x<<24)^y>>>7,k+=65535&(C=(x>>>1|y<<31)^(x>>>8|y<<24)^(x>>>7|y<<25)),O+=C>>>16,T+=65535&w,P+=w>>>16,w=((y=A[(E+14)%16])>>>19|(x=R[(E+14)%16])<<13)^(x>>>29|y<<3)^y>>>6,k+=65535&(C=(x>>>19|y<<13)^(y>>>29|x<<3)^(x>>>6|y<<26)),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,A[E]=65535&T|P<<16,R[E]=65535&k|O<<16;w=N,k=65535&(C=q),O=C>>>16,T=65535&w,P=w>>>16,w=t[0],k+=65535&(C=e[0]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[0]=N=65535&T|P<<16,e[0]=q=65535&k|O<<16,w=L,k=65535&(C=j),O=C>>>16,T=65535&w,P=w>>>16,w=t[1],k+=65535&(C=e[1]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[1]=L=65535&T|P<<16,e[1]=j=65535&k|O<<16,w=U,k=65535&(C=z),O=C>>>16,T=65535&w,P=w>>>16,w=t[2],k+=65535&(C=e[2]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[2]=U=65535&T|P<<16,e[2]=z=65535&k|O<<16,w=D,k=65535&(C=F),O=C>>>16,T=65535&w,P=w>>>16,w=t[3],k+=65535&(C=e[3]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[3]=D=65535&T|P<<16,e[3]=F=65535&k|O<<16,w=I,k=65535&(C=K),O=C>>>16,T=65535&w,P=w>>>16,w=t[4],k+=65535&(C=e[4]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[4]=I=65535&T|P<<16,e[4]=K=65535&k|O<<16,w=M,k=65535&(C=G),O=C>>>16,T=65535&w,P=w>>>16,w=t[5],k+=65535&(C=e[5]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[5]=M=65535&T|P<<16,e[5]=G=65535&k|O<<16,w=H,k=65535&(C=Y),O=C>>>16,T=65535&w,P=w>>>16,w=t[6],k+=65535&(C=e[6]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[6]=H=65535&T|P<<16,e[6]=Y=65535&k|O<<16,w=B,k=65535&(C=W),O=C>>>16,T=65535&w,P=w>>>16,w=t[7],k+=65535&(C=e[7]),O+=C>>>16,T+=65535&w,P+=w>>>16,O+=k>>>16,T+=O>>>16,P+=T>>>16,t[7]=B=65535&T|P<<16,e[7]=W=65535&k|O<<16,$+=128,s-=128}return s}function X(t,e,r){var s,n=new Int32Array(8),i=new Int32Array(8),o=new Uint8Array(256),a=r;for(n[0]=0x6a09e667,n[1]=0xbb67ae85,n[2]=0x3c6ef372,n[3]=0xa54ff53a,n[4]=0x510e527f,n[5]=0x9b05688c,n[6]=0x1f83d9ab,n[7]=0x5be0cd19,i[0]=0xf3bcc908,i[1]=0x84caa73b,i[2]=0xfe94f82b,i[3]=0x5f1d36f1,i[4]=0xade682d1,i[5]=0x2b3e6c1f,i[6]=0xfb41bd6b,i[7]=0x137e2179,$(n,i,e,r),r%=128,s=0;s<r;s++)o[s]=e[a-r+s];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,g(o,r-8,a/0x20000000|0,a<<3),$(n,i,o,r),s=0;s<8;s++)g(t,8*s,n[s],i[s]);return 0}function J(t,e){var r=s(),n=s(),i=s(),o=s(),a=s(),h=s(),c=s(),u=s(),d=s();B(r,t[1],t[0]),B(d,e[1],e[0]),q(r,r,d),H(n,t[0],t[1]),H(d,e[0],e[1]),q(n,n,d),q(i,t[3],e[3]),q(i,i,l),q(o,t[2],e[2]),H(o,o,o),B(a,n,r),B(h,o,i),H(c,o,i),H(u,n,r),q(t[0],a,h),q(t[1],u,c),q(t[2],c,h),q(t[3],a,u)}function Z(t,e,r){var s;for(s=0;s<4;s++)L(t[s],e[s],r)}function Q(t,e){var r=s(),n=s(),i=s();z(i,e[2]),q(r,e[0],i),q(n,e[1],i),U(t,n),t[31]^=I(r)<<7}function tt(t,e,r){var s,n;for(R(t[0],a),R(t[1],h),R(t[2],h),R(t[3],a),n=255;n>=0;--n)Z(t,e,s=r[n/8|0]>>(7&n)&1),J(e,t),J(t,t),Z(t,e,s)}function te(t,e){var r=[s(),s(),s(),s()];R(r[0],d),R(r[1],f),R(r[2],h),q(r[3],d,f),tt(t,r,e)}function tr(t,e,r){var i,o=new Uint8Array(64),a=[s(),s(),s(),s()];for(r||n(e,32),X(o,e,32),o[0]&=248,o[31]&=127,o[31]|=64,te(a,o),Q(t,a),i=0;i<32;i++)e[i+32]=t[i];return 0}var ts=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function tn(t,e){var r,s,n,i;for(s=63;s>=32;--s){for(r=0,n=s-32,i=s-12;n<i;++n)e[n]+=r-16*e[s]*ts[n-(s-32)],r=Math.floor((e[n]+128)/256),e[n]-=256*r;e[n]+=r,e[s]=0}for(n=0,r=0;n<32;n++)e[n]+=r-(e[31]>>4)*ts[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;n++)e[n]-=r*ts[n];for(s=0;s<32;s++)e[s+1]+=e[s]>>8,t[s]=255&e[s]}function ti(t){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=t[e];for(e=0;e<64;e++)t[e]=0;tn(t,r)}function to(t,e,r,n){var i,o,a=new Uint8Array(64),h=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),l=[s(),s(),s(),s()];for(X(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,i=0;i<r;i++)t[64+i]=e[i];for(i=0;i<32;i++)t[32+i]=a[32+i];for(X(c,t.subarray(32),r+32),ti(c),te(l,c),Q(t,l),i=32;i<64;i++)t[i]=n[i];for(X(h,t,r+64),ti(h),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=c[i];for(i=0;i<32;i++)for(o=0;o<32;o++)u[i+o]+=h[i]*a[o];return tn(t.subarray(32),u),r+64}function ta(t,e,r,n){var i,o,c,l,d,f,g,_,v=new Uint8Array(32),b=new Uint8Array(64),y=[s(),s(),s(),s()],x=[s(),s(),s(),s()];if(r<64||(i=s(),o=s(),c=s(),l=s(),d=s(),f=s(),g=s(),(R(x[2],h),M(x[1],n),j(c,x[1]),q(l,c,u),B(c,c,x[2]),H(l,x[2],l),j(d,l),j(f,d),q(g,f,d),q(i,g,c),q(i,i,l),F(i,i),q(i,i,c),q(i,i,l),q(i,i,l),q(x[0],i,l),j(o,x[0]),q(o,o,l),D(o,c)&&q(x[0],x[0],p),j(o,x[0]),q(o,o,l),D(o,c))?-1:(I(x[0])===n[31]>>7&&B(x[0],a,x[0]),q(x[3],x[0],x[1]),0)))return -1;for(_=0;_<r;_++)t[_]=e[_];for(_=0;_<32;_++)t[_+32]=n[_];if(X(b,t,r),ti(b),tt(y,x,b),te(x,e.subarray(32)),J(y,x),Q(v,y),r-=64,m(e,0,v,0)){for(_=0;_<r;_++)t[_]=0;return -1}for(_=0;_<r;_++)t[_]=e[_+64];return r}function th(t,e){if(32!==t.length)throw Error("bad key size");if(24!==e.length)throw Error("bad nonce size")}function tc(){for(var t=0;t<arguments.length;t++)if(!(arguments[t]instanceof Uint8Array))throw TypeError("unexpected type, use Uint8Array")}function tu(t){for(var e=0;e<t.length;e++)t[e]=0}t.lowlevel={crypto_core_hsalsa20:y,crypto_stream_xor:C,crypto_stream:w,crypto_stream_salsa20_xor:S,crypto_stream_salsa20:E,crypto_onetimeauth:O,crypto_onetimeauth_verify:T,crypto_verify_16:v,crypto_verify_32:m,crypto_secretbox:P,crypto_secretbox_open:A,crypto_scalarmult:K,crypto_scalarmult_base:G,crypto_box_beforenm:W,crypto_box_afternm:P,crypto_box:function(t,e,r,s,n,i){var o=new Uint8Array(32);return W(o,n,i),P(t,e,r,s,o)},crypto_box_open:function(t,e,r,s,n,i){var o=new Uint8Array(32);return W(o,n,i),A(t,e,r,s,o)},crypto_box_keypair:Y,crypto_hash:X,crypto_sign:to,crypto_sign_keypair:tr,crypto_sign_open:ta,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:s,D:u,L:ts,pack25519:U,unpack25519:M,M:q,A:H,S:j,Z:B,pow2523:F,add:J,set25519:R,modL:tn,scalarmult:tt,scalarbase:te},t.randomBytes=function(t){var e=new Uint8Array(t);return n(e,t),e},t.secretbox=function(t,e,r){tc(t,e,r),th(r,e);for(var s=new Uint8Array(32+t.length),n=new Uint8Array(s.length),i=0;i<t.length;i++)s[i+32]=t[i];return P(n,s,s.length,e,r),n.subarray(16)},t.secretbox.open=function(t,e,r){tc(t,e,r),th(r,e);for(var s=new Uint8Array(16+t.length),n=new Uint8Array(s.length),i=0;i<t.length;i++)s[i+16]=t[i];return s.length<32||0!==A(n,s,s.length,e,r)?null:n.subarray(32)},t.secretbox.keyLength=32,t.secretbox.nonceLength=24,t.secretbox.overheadLength=16,t.scalarMult=function(t,e){if(tc(t,e),32!==t.length)throw Error("bad n size");if(32!==e.length)throw Error("bad p size");var r=new Uint8Array(32);return K(r,t,e),r},t.scalarMult.base=function(t){if(tc(t),32!==t.length)throw Error("bad n size");var e=new Uint8Array(32);return G(e,t),e},t.scalarMult.scalarLength=32,t.scalarMult.groupElementLength=32,t.box=function(e,r,s,n){var i=t.box.before(s,n);return t.secretbox(e,r,i)},t.box.before=function(t,e){tc(t,e),function(t,e){if(32!==t.length)throw Error("bad public key size");if(32!==e.length)throw Error("bad secret key size")}(t,e);var r=new Uint8Array(32);return W(r,t,e),r},t.box.after=t.secretbox,t.box.open=function(e,r,s,n){var i=t.box.before(s,n);return t.secretbox.open(e,r,i)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var t=new Uint8Array(32),e=new Uint8Array(32);return Y(t,e),{publicKey:t,secretKey:e}},t.box.keyPair.fromSecretKey=function(t){if(tc(t),32!==t.length)throw Error("bad secret key size");var e=new Uint8Array(32);return G(e,t),{publicKey:e,secretKey:new Uint8Array(t)}},t.box.publicKeyLength=32,t.box.secretKeyLength=32,t.box.sharedKeyLength=32,t.box.nonceLength=24,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(t,e){if(tc(t,e),64!==e.length)throw Error("bad secret key size");var r=new Uint8Array(64+t.length);return to(r,t,t.length,e),r},t.sign.open=function(t,e){if(tc(t,e),32!==e.length)throw Error("bad public key size");var r=new Uint8Array(t.length),s=ta(r,t,t.length,e);if(s<0)return null;for(var n=new Uint8Array(s),i=0;i<n.length;i++)n[i]=r[i];return n},t.sign.detached=function(e,r){for(var s=t.sign(e,r),n=new Uint8Array(64),i=0;i<n.length;i++)n[i]=s[i];return n},t.sign.detached.verify=function(t,e,r){if(tc(t,e,r),64!==e.length)throw Error("bad signature size");if(32!==r.length)throw Error("bad public key size");var s,n=new Uint8Array(64+t.length),i=new Uint8Array(64+t.length);for(s=0;s<64;s++)n[s]=e[s];for(s=0;s<t.length;s++)n[s+64]=t[s];return ta(i,n,n.length,r)>=0},t.sign.keyPair=function(){var t=new Uint8Array(32),e=new Uint8Array(64);return tr(t,e),{publicKey:t,secretKey:e}},t.sign.keyPair.fromSecretKey=function(t){if(tc(t),64!==t.length)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=t[32+r];return{publicKey:e,secretKey:new Uint8Array(t)}},t.sign.keyPair.fromSeed=function(t){if(tc(t),32!==t.length)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),s=0;s<32;s++)r[s]=t[s];return tr(e,r,!0),{publicKey:e,secretKey:r}},t.sign.publicKeyLength=32,t.sign.secretKeyLength=64,t.sign.seedLength=32,t.sign.signatureLength=64,t.hash=function(t){tc(t);var e=new Uint8Array(64);return X(e,t,t.length),e},t.hash.hashLength=64,t.verify=function(t,e){return tc(t,e),0!==t.length&&0!==e.length&&t.length===e.length&&0===_(t,0,e,0,t.length)},t.setPRNG=function(t){n=t},(e="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&e.getRandomValues?t.setPRNG(function(t,r){var s,n=new Uint8Array(r);for(s=0;s<r;s+=65536)e.getRandomValues(n.subarray(s,s+Math.min(r-s,65536)));for(s=0;s<r;s++)t[s]=n[s];tu(n)}):(e=r(3))&&e.randomBytes&&t.setPRNG(function(t,r){var s,n=e.randomBytes(r);for(s=0;s<r;s++)t[s]=n[s];tu(n)})}(t.exports?t.exports:self.nacl=self.nacl||{})},function(t,e,r){t.exports=r(47).default},function(t,e){t.exports=r(79428)},function(t,e){t.exports=r(94735)},function(t,e,r){"use strict";var s=r(5).Stream,n=r(0),i=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};n.inherits(i,s),i.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0},i.prototype.resume=function(){this._paused=!1,this.emit("drain");var t=this._driver.messages;t._paused=!1,t.emit("drain")},i.prototype.write=function(t){return!!this.writable&&(this._driver.parse(t),!this._paused)},i.prototype.end=function(t){if(this.writable){void 0!==t&&this.write(t),this.writable=!1;var e=this._driver.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))}},i.prototype.destroy=function(){this.end()};var o=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};n.inherits(o,s),o.prototype.pause=function(){this._driver.io._paused=!0},o.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")},o.prototype.write=function(t){return!!this.writable&&("string"==typeof t?this._driver.text(t):this._driver.binary(t),!this._paused)},o.prototype.end=function(t){void 0!==t&&this.write(t)},o.prototype.destroy=function(){},e.IO=i,e.Messages=o},function(t,e,r){"use strict";var s=r(1).Buffer,n=function(){this._queue=[],this._queueSize=0,this._offset=0};n.prototype.put=function(t){t&&0!==t.length&&(s.isBuffer(t)||(t=s.from(t)),this._queue.push(t),this._queueSize+=t.length)},n.prototype.read=function(t){if(t>this._queueSize)return null;if(0===t)return s.alloc(0);this._queueSize-=t;var e,r,n=this._queue,i=t,o=n[0];if(o.length>=t)return o.length===t?n.shift():(r=o.slice(0,t),n[0]=o.slice(t),r);for(var a=0,h=n.length;a<h&&!(i<n[a].length);a++)i-=n[a].length;return e=n.splice(0,a),i>0&&n.length>0&&(e.push(n[0].slice(0,i)),n[0]=n[0].slice(i)),s.concat(e,t)},n.prototype.eachByte=function(t,e){for(var r,s,n;this._queue.length>0;){for(s=(r=this._queue[0]).length;this._offset<s;)n=this._offset,this._offset+=1,t.call(e,r[n]);this._offset=0,this._queue.shift()}},t.exports=n},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(3),i=r(6),o=r(0),a=r(10),h=r(2),c=r(12),u=r(36),l=function(t,e){this.version="hybi-"+c.VERSION,c.call(this,null,t,e),this.readyState=-1,this._key=l.generateKey(),this._accept=c.generateAccept(this._key),this._http=new a("response");var r=i.parse(this.url),n=r.auth&&s.from(r.auth,"utf8").toString("base64");if(0>this.VALID_PROTOCOLS.indexOf(r.protocol))throw Error(this.url+" is not a valid WebSocket URL");this._pathname=(r.pathname||"/")+(r.search||""),this._headers.set("Host",r.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",c.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),n&&this._headers.set("Authorization","Basic "+n)};o.inherits(l,c),l.generateKey=function(){return n.randomBytes(16).toString("base64")};var d={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(t,e){return new u(this,t,e)},start:function(){return -1===this.readyState&&(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(t){if(3!==this.readyState){if(this.readyState>0)return c.prototype.parse.call(this,t);this._http.parse(t),this._http.isComplete()&&(this._validateHandshake(),3!==this.readyState&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var t=this._extensions.generateOffer();t&&this._headers.set("Sec-WebSocket-Extensions",t);var e=["GET "+this._pathname+" HTTP/1.1",this._headers.toString(),""];return s.from(e.join("\r\n"),"utf8")},_failHandshake:function(t){t="Error during WebSocket handshake: "+t,this.readyState=3,this.emit("error",Error(t)),this.emit("close",new h.CloseEvent(this.ERRORS.protocol_error,t))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(101!==this._http.statusCode)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var t=this._http.headers,e=t.upgrade||"",r=t.connection||"",s=t["sec-websocket-accept"]||"",n=t["sec-websocket-protocol"]||"";if(""===e)return this._failHandshake("'Upgrade' header is missing");if("websocket"!==e.toLowerCase())return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(""===r)return this._failHandshake("'Connection' header is missing");if("upgrade"!==r.toLowerCase())return this._failHandshake("'Connection' header value is not 'Upgrade'");if(s!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,""!==n){if(0>this._protocols.indexOf(n))return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=n}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(t){return this._failHandshake(t.message)}}};for(var f in d)l.prototype[f]=d[f];t.exports=l},function(t,e,r){var s=r(28);function n(t){s.ok(t===n.REQUEST||t===n.RESPONSE||void 0===t),void 0===t||this.initialize(t),this.maxHeaderSize=n.maxHeaderSize}e.HTTPParser=n,n.prototype.initialize=function(t,e){s.ok(t===n.REQUEST||t===n.RESPONSE),this.type=t,this.state=t+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1},n.encoding="ascii",n.maxHeaderSize=81920,n.REQUEST="REQUEST",n.RESPONSE="RESPONSE";var i=n.kOnHeaders=1,o=n.kOnHeadersComplete=2,a=n.kOnBody=3,h=n.kOnMessageComplete=4;n.prototype[i]=n.prototype[o]=n.prototype[a]=n.prototype[h]=function(){};var c=!0;Object.defineProperty(n,"kOnExecute",{get:function(){return c=!1,99}});var u=e.methods=n.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],l=u.indexOf("CONNECT");n.prototype.reinitialize=n,n.prototype.close=n.prototype.pause=n.prototype.resume=n.prototype.free=function(){},n.prototype._compatMode0_11=!1,n.prototype.getAsyncId=function(){return 0};var d={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};n.prototype.execute=function(t,e,r){if(!(this instanceof n))throw TypeError("not a HTTPParser");e=e||0,r="number"==typeof r?r:t.length,this.chunk=t,this.offset=e;var s=this.end=e+r;try{for(;this.offset<s&&!this[this.state](););}catch(t){if(this.isUserCall)throw t;return this.hadError=!0,t}return(this.chunk=null,r=this.offset-e,d[this.state]&&(this.headerSize+=r,this.headerSize>(this.maxHeaderSize||n.maxHeaderSize)))?Error("max header size exceeded"):r};var f={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};n.prototype.finish=function(){if(!this.hadError){if(!f[this.state])return Error("invalid state for EOF");"BODY_RAW"===this.state&&this.userCall()(this[h]())}},n.prototype.consume=n.prototype.unconsume=n.prototype.getCurrentBuffer=function(){},n.prototype.userCall=function(){this.isUserCall=!0;var t=this;return function(e){return t.isUserCall=!1,e}},n.prototype.nextRequest=function(){this.userCall()(this[h]()),this.reinitialize(this.type)},n.prototype.consumeLine=function(){for(var t=this.end,e=this.chunk,r=this.offset;r<t;r++)if(10===e[r]){var s=this.line+e.toString(n.encoding,this.offset,r);return"\r"===s.charAt(s.length-1)&&(s=s.substr(0,s.length-1)),this.line="",this.offset=r+1,s}this.line+=e.toString(n.encoding,this.offset,this.end),this.offset=this.end};var p=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,g=/^[ \t]+(.*[^ \t])/;n.prototype.parseHeader=function(t,e){if(-1!==t.indexOf("\r"))throw m("HPE_LF_EXPECTED");var r=p.exec(t),s=r&&r[1];if(s)e.push(s),e.push(r[2]);else{var n=g.exec(t);n&&e.length&&(e[e.length-1]&&(e[e.length-1]+=" "),e[e.length-1]+=n[1])}};var _=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;n.prototype.REQUEST_LINE=function(){var t=this.consumeLine();if(t){var e=_.exec(t);if(null===e)throw m("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?e[1]:u.indexOf(e[1]),-1===this.info.method)throw Error("invalid request method");this.info.url=e[2],this.info.versionMajor=+e[3],this.info.versionMinor=+e[4],this.body_bytes=0,this.state="HEADER"}};var v=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;function m(t){var e=Error("Parse Error");return e.code=t,e}n.prototype.RESPONSE_LINE=function(){var t=this.consumeLine();if(t){var e=v.exec(t);if(null===e)throw m("HPE_INVALID_CONSTANT");this.info.versionMajor=+e[1],this.info.versionMinor=+e[2];var r=this.info.statusCode=+e[3];this.info.statusMessage=e[4],((r/100|0)==1||204===r||304===r)&&(this.body_bytes=0),this.state="HEADER"}},n.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(-1!==this.connection.indexOf("close"))return!1}else if(-1===this.connection.indexOf("keep-alive"))return!1;return null!==this.body_bytes||!!this.isChunked},n.prototype.HEADER=function(){var t=this.consumeLine();if(void 0!==t){var e=this.info;if(t)this.parseHeader(t,e.headers);else{for(var r,s,i=e.headers,a=!1,h=!1,u=0;u<i.length;u+=2)switch(i[u].toLowerCase()){case"transfer-encoding":this.isChunked="chunked"===i[u+1].toLowerCase();break;case"content-length":if(r=+i[u+1],a){if(r!==this.body_bytes)throw m("HPE_UNEXPECTED_CONTENT_LENGTH")}else a=!0,this.body_bytes=r;break;case"connection":this.connection+=i[u+1].toLowerCase();break;case"upgrade":h=!0}if(this.isChunked&&a&&(a=!1,this.body_bytes=null),h&&-1!=this.connection.indexOf("upgrade")?e.upgrade=this.type===n.REQUEST||101===e.statusCode:e.upgrade=e.method===l,this.isChunked&&e.upgrade&&(this.isChunked=!1),e.shouldKeepAlive=this.shouldKeepAlive(),2===(s=c?this.userCall()(this[o](e)):this.userCall()(this[o](e.versionMajor,e.versionMinor,e.headers,e.method,e.url,e.statusCode,e.statusMessage,e.upgrade,e.shouldKeepAlive))))return this.nextRequest(),!0;if(this.isChunked&&!s)this.state="BODY_CHUNKHEAD";else{if(s||0===this.body_bytes)return this.nextRequest(),e.upgrade;null===this.body_bytes?this.state="BODY_RAW":this.state="BODY_SIZED"}}}},n.prototype.BODY_CHUNKHEAD=function(){var t=this.consumeLine();void 0!==t&&(this.body_bytes=parseInt(t,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")},n.prototype.BODY_CHUNK=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")},n.prototype.BODY_CHUNKEMPTYLINE=function(){var t=this.consumeLine();void 0!==t&&(s.equal(t,""),this.state="BODY_CHUNKHEAD")},n.prototype.BODY_CHUNKTRAILERS=function(){var t=this.consumeLine();void 0!==t&&(t?this.parseHeader(t,this.trailers):(this.trailers.length&&this.userCall()(this[i](this.trailers,"")),this.nextRequest()))},n.prototype.BODY_RAW=function(){var t=this.end-this.offset;this.userCall()(this[a](this.chunk,this.offset,t)),this.offset=this.end},n.prototype.BODY_SIZED=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||this.nextRequest()},["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(t){var e=n["kOn"+t];Object.defineProperty(n.prototype,"on"+t,{get:function(){return this[e]},set:function(t){return this._compatMode0_11=!0,l="CONNECT",this[e]=t}})})},function(t,e){t.exports=r(12412)},function(t,e,r){"use strict";var s=r(30),n=r(31),i=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};i.MESSAGE_OPCODES=[1,2];var o={add:function(t){if("string"!=typeof t.name)throw TypeError("extension.name must be a string");if("permessage"!==t.type)throw TypeError('extension.type must be "permessage"');if("boolean"!=typeof t.rsv1)throw TypeError("extension.rsv1 must be true or false");if("boolean"!=typeof t.rsv2)throw TypeError("extension.rsv2 must be true or false");if("boolean"!=typeof t.rsv3)throw TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(t.name))throw TypeError('An extension with name "'+t.name+'" is already registered');this._byName[t.name]=t,this._inOrder.push(t)},generateOffer:function(){var t=[],e=[],r={};return this._inOrder.forEach(function(n){var i=n.createClientSession();if(i){var o=[n,i];t.push(o),r[n.name]=o;var a=i.generateOffer();(a=a?[].concat(a):[]).forEach(function(t){e.push(s.serializeParams(n.name,t))},this)}},this),this._sessions=t,this._index=r,e.length>0?e.join(", "):null},activate:function(t){var e=s.parseHeader(t),r=[];e.eachOffer(function(t,e){var n=this._index[t];if(!n)throw Error('Server sent an extension response for unknown extension "'+t+'"');var i=n[0],o=n[1],a=this._reserved(i);if(a)throw Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+i.name+'"');if(!0!==o.activate(e))throw Error("Server sent unacceptable extension parameters: "+s.serializeParams(t,e));this._reserve(i),r.push(n)},this),this._sessions=r,this._pipeline=new n(r)},generateResponse:function(t){var e=[],r=[],i=s.parseHeader(t);return this._inOrder.forEach(function(t){var n=i.byName(t.name);if(!(0===n.length||this._reserved(t))){var o=t.createServerSession(n);o&&(this._reserve(t),e.push([t,o]),r.push(s.serializeParams(t.name,o.generateResponse())))}},this),this._sessions=e,this._pipeline=new n(e),r.length>0?r.join(", "):null},validFrameRsv:function(t){var e,r={rsv1:!1,rsv2:!1,rsv3:!1};if(i.MESSAGE_OPCODES.indexOf(t.opcode)>=0)for(var s=0,n=this._sessions.length;s<n;s++)e=this._sessions[s][0],r.rsv1=r.rsv1||e.rsv1,r.rsv2=r.rsv2||e.rsv2,r.rsv3=r.rsv3||e.rsv3;return(r.rsv1||!t.rsv1)&&(r.rsv2||!t.rsv2)&&(r.rsv3||!t.rsv3)},processIncomingMessage:function(t,e,r){this._pipeline.processIncomingMessage(t,e,r)},processOutgoingMessage:function(t,e,r){this._pipeline.processOutgoingMessage(t,e,r)},close:function(t,e){if(!this._pipeline)return t.call(e);this._pipeline.close(t,e)},_reserve:function(t){this._rsv1=this._rsv1||t.rsv1&&t.name,this._rsv2=this._rsv2||t.rsv2&&t.name,this._rsv3=this._rsv3||t.rsv3&&t.name},_reserved:function(t){return this._rsv1&&t.rsv1?[1,this._rsv1]:this._rsv2&&t.rsv2?[2,this._rsv2]:!!this._rsv3&&!!t.rsv3&&[3,this._rsv3]}};for(var a in o)i.prototype[a]=o[a];t.exports=i},function(t,e,r){"use strict";var s=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,n=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,i=RegExp(s.source+"(?:=(?:"+s.source+"|"+/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/.source+"))?"),o=RegExp(s.source+"(?: *; *"+i.source+")*","g"),a=RegExp("^"+o.source+"(?: *, *"+o.source+")*$"),h=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,c=Object.prototype.hasOwnProperty,u=function(){this._byName={},this._inOrder=[]};u.prototype.push=function(t,e){c.call(this._byName,t)||(this._byName[t]=[]),this._byName[t].push(e),this._inOrder.push({name:t,params:e})},u.prototype.eachOffer=function(t,e){for(var r=this._inOrder,s=0,n=r.length;s<n;s++)t.call(e,r[s].name,r[s].params)},u.prototype.byName=function(t){return this._byName[t]||[]},u.prototype.toArray=function(){return this._inOrder.slice()},t.exports={parseHeader:function(t){var e=new u;if(""===t||void 0===t)return e;if(!a.test(t))throw SyntaxError("Invalid Sec-WebSocket-Extensions header: "+t);return t.match(o).forEach(function(t){var r=t.match(RegExp(i.source,"g")),s=r.shift(),n={};r.forEach(function(t){var e,r=t.match(i),s=r[1];e=void 0!==r[2]?r[2]:void 0===r[3]||r[3].replace(/\\/g,""),h.test(e)&&(e=parseFloat(e)),c.call(n,s)?(n[s]=[].concat(n[s]),n[s].push(e)):n[s]=e},this),e.push(s,n)},this),e},serializeParams:function(t,e){var r=[],s=function(t,e){e instanceof Array?e.forEach(function(e){s(t,e)}):!0===e?r.push(t):"number"==typeof e?r.push(t+"="+e):n.test(e)?r.push(t+'="'+e.replace(/"/g,'\\"')+'"'):r.push(t+"="+e)};for(var i in e)s(i,e[i]);return[t].concat(r).join("; ")}}},function(t,e,r){"use strict";var s=r(32),n=r(14),i=function(t){this._cells=t.map(function(t){return new s(t)}),this._stopped={incoming:!1,outgoing:!1}};i.prototype.processIncomingMessage=function(t,e,r){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,t,e,r)},i.prototype.processOutgoingMessage=function(t,e,r){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,t,e,r)},i.prototype.close=function(t,e){this._stopped={incoming:!0,outgoing:!0};var r=this._cells.map(function(t){return t.close()});t&&n.all(r).then(function(){t.call(e)})},i.prototype._loop=function(t,e,r,s,n,i,o){for(var a=this._cells,h=a.length,c=this;h--;)a[h].pending(t);var u=function(e,n,h){if(e===r)return i.call(o,n,h);a[e][t](n,h,function(r,n){r&&(c._stopped[t]=!0),u(e+s,r,n)})};u(e,null,n)},t.exports=i},function(t,e,r){"use strict";var s=r(33),n=r(14),i=function(t){this._ext=t[0],this._session=t[1],this._functors={incoming:new s(this._session,"processIncomingMessage"),outgoing:new s(this._session,"processOutgoingMessage")}};i.prototype.pending=function(t){var e=this._functors[t];e._stopped||(e.pending+=1)},i.prototype.incoming=function(t,e,r,s){this._exec("incoming",t,e,r,s)},i.prototype.outgoing=function(t,e,r,s){this._exec("outgoing",t,e,r,s)},i.prototype.close=function(){return this._closed=this._closed||new n,this._doClose(),this._closed},i.prototype._exec=function(t,e,r,s,n){this._functors[t].call(e,r,function(t,e){t&&(t.message=this._ext.name+": "+t.message),s.call(n,t,e),this._doClose()},this)},i.prototype._doClose=function(){var t=this._functors.incoming,e=this._functors.outgoing;this._closed&&t.pending+e.pending===0&&(this._session&&this._session.close(),this._session=null,this._closed.done())},t.exports=i},function(t,e,r){"use strict";var s=r(13),n=function(t,e){this._session=t,this._method=e,this._queue=new s(n.QUEUE_SIZE),this._stopped=!1,this.pending=0};n.QUEUE_SIZE=8,n.prototype.call=function(t,e,r,s){if(!this._stopped){var n={error:t,message:e,callback:r,context:s,done:!1},i=!1,o=this;if(this._queue.push(n),n.error)return n.done=!0,this._stop(),this._flushQueue();var a=function(t,e){i^(i=!0)&&(t?(o._stop(),n.error=t,n.message=null):n.message=e,n.done=!0,o._flushQueue())};try{this._session[this._method](e,a)}catch(t){a(t)}}},n.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0},n.prototype._flushQueue=function(){for(var t,e=this._queue;e.length>0&&e.peek().done;)(t=e.shift()).error?(this.pending=0,e.clear()):this.pending-=1,t.callback.call(t.context,t.error,t.message)},t.exports=n},function(t,e,r){"use strict";var s=function(){},n={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(var i in n)s.prototype[i]=n[i];t.exports=s},function(t,e,r){"use strict";var s=r(1).Buffer,n=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},i={read:function(){return this.data=this.data||s.concat(this._chunks,this.length)},pushFrame:function(t){this.rsv1=this.rsv1||t.rsv1,this.rsv2=this.rsv2||t.rsv2,this.rsv3=this.rsv3||t.rsv3,null===this.opcode&&(this.opcode=t.opcode),this._chunks.push(t.payload),this.length+=t.length}};for(var o in i)n.prototype[o]=i[o];t.exports=n},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(5).Stream,i=r(6),o=r(0),a=r(2),h=r(9),c=r(10),u={"ws:":80,"wss:":443},l=function(t,e,r){this._client=t,this._http=new c("response"),this._origin="object"==typeof t.url?t.url:i.parse(t.url),this._url="object"==typeof e?e:i.parse(e),this._options=r||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new h,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var n=this._url.auth&&s.from(this._url.auth,"utf8").toString("base64");n&&this._headers.set("Proxy-Authorization","Basic "+n)};o.inherits(l,n);var d={setHeader:function(t,e){return 0===this._state&&(this._headers.set(t,e),!0)},start:function(){if(0!==this._state)return!1;this._state=1;var t=this._origin,e=t.port||u[t.protocol],r=["CONNECT "+t.hostname+":"+e+" HTTP/1.1",this._headers.toString(),""];return this.emit("data",s.from(r.join("\r\n"),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(t){if(!this.writable)return!1;if(this._http.parse(t),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,200===this.statusCode)this.emit("connect",new a.ConnectEvent);else{var e="Can't establish a connection to the server at "+this._origin.href;this.emit("error",Error(e))}return this.end(),!this._paused},end:function(t){this.writable&&(void 0!==t&&this.write(t),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(var f in d)l.prototype[f]=d[f];t.exports=l},function(t,e,r){"use strict";var s=r(0),n=r(10),i=r(2),o=r(15),a=r(38),h=r(12),c=function(t){i.call(this,null,null,t),this._http=new n("request")};s.inherits(c,i);var u={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(t){if(this._delegate)return this._delegate.parse(t);if(this._http.parse(t),this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var e=this;this._delegate=c.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(t){this._delegate.on(t,function(r){e.emit(t,r)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new i.ConnectEvent)}},_open:function(){this.__queue.forEach(function(t){this._delegate[t[0]].apply(this._delegate,t[1])},this),this.__queue=[]}};for(var l in["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(t){u[t]=function(){return this._delegate?this._delegate[t].apply(this._delegate,arguments):(this.__queue.push([t,arguments]),!0)}}),u)c.prototype[l]=u[l];c.isSecureRequest=function(t){if(t.connection&&void 0!==t.connection.authorized||t.socket&&t.socket.secure)return!0;var e=t.headers;return!!e&&("on"===e.https||"on"===e["x-forwarded-ssl"]||"https"===e["x-forwarded-scheme"]||"https"===e["x-forwarded-proto"])},c.determineUrl=function(t){return(this.isSecureRequest(t)?"wss:":"ws:")+"//"+t.headers.host+t.url},c.http=function(t,e){void 0===(e=e||{}).requireMasking&&(e.requireMasking=!0);var r=t.headers,s=r["sec-websocket-version"],n=r["sec-websocket-key"],i=r["sec-websocket-key1"],c=r["sec-websocket-key2"],u=this.determineUrl(t);return s||n?new h(t,u,e):i||c?new a(t,u,e):new o(t,u,e)},t.exports=c},function(t,e,r){"use strict";var s=r(1).Buffer,n=r(2),i=r(15),o=r(3),a=r(0),h=function(t){return parseInt((t.match(/[0-9]/g)||[]).join(""),10)},c=function(t){return(t.match(/ /g)||[]).length},u=function(t,e,r){i.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};a.inherits(u,i);var l={BODY_SIZE:8,start:function(){return!!i.prototype.start.call(this)&&(this._started=!0,this._sendHandshakeBody(),!0)},close:function(){return 3!==this.readyState&&(1===this.readyState&&this._write(s.from([255,0])),this.readyState=3,this.emit("close",new n.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var t=this._request.headers,e=t["sec-websocket-key1"],r=t["sec-websocket-key2"];if(!e)throw Error("Missing required header: Sec-WebSocket-Key1");if(!r)throw Error("Missing required header: Sec-WebSocket-Key2");var n=h(e),i=c(e),o=h(r),a=c(r);if(n%i!=0||o%a!=0)throw Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[n/i,o/a];var t=["HTTP/1.1 101 WebSocket Protocol Handshake",this._headers.toString(),""];return s.from(t.join("\r\n"),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var t=o.createHash("md5"),e=s.allocUnsafe(8+this.BODY_SIZE);return e.writeUInt32BE(this._keyValues[0],0),e.writeUInt32BE(this._keyValues[1],4),s.from(this._body).copy(e,8,0,this.BODY_SIZE),t.update(e),s.from(t.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var t=this._handshakeSignature();t&&(this._write(t),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(t){if(255!==t)return i.prototype._parseLeadingByte.call(this,t);this._closing=!0,this._length=0,this._stage=1}};for(var d in l)u.prototype[d]=l[d];t.exports=u},function(t,e,r){"use strict";var s=r(0),n=r(40),i=r(41),o=r(6),a=r(4),h=r(11);r(7);var c={"http:":80,"https:":443,"ws:":80,"wss:":443},u=["https:","wss:"],l=function(t,e,r){r=r||{},this.url=t,this._driver=a.client(this.url,{maxLength:r.maxLength,protocols:e}),["open","error"].forEach(function(t){this._driver.on(t,function(){m.headers=m._driver.headers,m.statusCode=m._driver.statusCode})},this);var s=r.proxy||{},l=o.parse(s.origin||this.url),d=l.port||c[l.protocol],f=u.indexOf(l.protocol)>=0,p=function(){m._onConnect()},g=r.net||{},_=r.tls||{},v=s.origin?s.tls||{}:_,m=this;g.host=v.host=l.hostname,g.port=v.port=d,_.ca=_.ca||r.ca,v.servername=v.servername||l.hostname,this._stream=f?i.connect(v,p):n.connect(g,p),s.origin&&this._configureProxy(s,_),h.call(this,r)};s.inherits(l,h),l.prototype._onConnect=function(){(this._proxy||this._driver).start()},l.prototype._configureProxy=function(t,e){var r,s=o.parse(this.url),n=u.indexOf(s.protocol)>=0,a=this;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(r in t.headers)this._proxy.setHeader(r,t.headers[r]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(n){var t={socket:a._stream,servername:s.hostname};for(r in e)t[r]=e[r];a._stream=i.connect(t),a._configureStream()}a._driver.io.pipe(a._stream),a._stream.pipe(a._driver.io),a._driver.start()}),this._proxy.on("error",function(t){a._driver.emit("error",t)})},t.exports=l},function(t,e){t.exports=r(91645)},function(t,e){t.exports=r(34631)},function(t,e,r){"use strict";var s=r(5).Stream,n=r(0),i=r(4),o=r(9),a=r(11),h=r(16),c=r(7),u=function(t,e,r){this.writable=!0,r=r||{},this._stream=e.socket,this._ping=r.ping||this.DEFAULT_PING,this._retry=r.retry||this.DEFAULT_RETRY;var s=i.isSecureRequest(t)?"https:":"http:";this.url=s+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=a.CONNECTING;var n=new o,h=this;if(r.headers)for(var c in r.headers)n.set(c,r.headers[c]);if(this._stream&&this._stream.writable){process.nextTick(function(){h._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var u="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+n.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(u),this._stream.on("drain",function(){h.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){h.ping()},1e3*this._ping)),["error","end"].forEach(function(t){h._stream.on(t,function(){h.close()})})}};n.inherits(u,s),u.isEventSource=function(t){return"GET"===t.method&&(t.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var l={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch(t){return!1}},_open:function(){if(this.readyState===a.CONNECTING){this.readyState=a.OPEN;var t=new c("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.write(t),this.close()},send:function(t,e){if(this.readyState>a.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: ");var r="";return(e=e||{}).event&&(r+="event: "+e.event+"\r\n"),e.id&&(r+="id: "+e.id+"\r\n"),r+="data: "+t+"\r\n\r\n",this._write(r)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>a.OPEN)return!1;this.readyState=a.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new c("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(var d in l)u.prototype[d]=l[d];for(var f in h)u.prototype[f]=h[f];t.exports=u},function(t,e){t.exports=r(79646)},function(t,e){t.exports=r(29021)},function(t,e){t.exports=r(81630)},function(t,e){t.exports=r(55591)},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return e_});for(var s,n,i,o,a,h,c=String.fromCharCode,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l={},d=0,f=u.length;d<f;d++)l[u.charAt(d)]=d;var p=function(t){var e=t.charCodeAt(0);return e<128?t:e<2048?c(192|e>>>6)+c(128|63&e):c(224|e>>>12&15)+c(128|e>>>6&63)+c(128|63&e)},g=function(t){var e=[0,2,1][t.length%3],r=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[u.charAt(r>>>18),u.charAt(r>>>12&63),e>=2?"=":u.charAt(r>>>6&63),e>=1?"=":u.charAt(63&r)].join("")},_=global.btoa||function(t){return t.replace(/[\s\S]{1,3}/g,g)};class v{constructor(t,e,r,s){this.clear=e,this.timer=t(()=>{this.timer&&(this.timer=s(this.timer))},r)}isRunning(){return null!==this.timer}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var m=v;function b(t){global.clearTimeout(t)}function y(t){global.clearInterval(t)}class x extends m{constructor(t,e){super(setTimeout,b,t,function(t){return e(),null})}}class S extends m{constructor(t,e){super(setInterval,y,t,function(t){return e(),t})}}var E={now:()=>Date.now?Date.now():new Date().valueOf(),defer:t=>new x(0,t),method(t,...e){var r=Array.prototype.slice.call(arguments,1);return function(e){return e[t].apply(e,r.concat(arguments))}}};function w(t,...e){for(var r=0;r<e.length;r++){var s=e[r];for(var n in s)s[n]&&s[n].constructor&&s[n].constructor===Object?t[n]=w(t[n]||{},s[n]):t[n]=s[n]}return t}function C(){for(var t=["Pusher"],e=0;e<arguments.length;e++)"string"==typeof arguments[e]?t.push(arguments[e]):t.push(U(arguments[e]));return t.join(" : ")}function k(t,e){var r=Array.prototype.indexOf;if(null===t)return -1;if(r&&t.indexOf===r)return t.indexOf(e);for(var s=0,n=t.length;s<n;s++)if(t[s]===e)return s;return -1}function O(t,e){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(t[r],r,t)}function T(t){var e=[];return O(t,function(t,r){e.push(r)}),e}function P(t,e,r){for(var s=0;s<t.length;s++)e.call(r||global,t[s],s,t)}function A(t,e){for(var r=[],s=0;s<t.length;s++)r.push(e(t[s],s,t,r));return r}function R(t,e){e=e||function(t){return!!t};for(var r=[],s=0;s<t.length;s++)e(t[s],s,t,r)&&r.push(t[s]);return r}function N(t,e){var r={};return O(t,function(s,n){(e&&e(s,n,t,r)||s)&&(r[n]=s)}),r}function L(t,e){for(var r=0;r<t.length;r++)if(e(t[r],r,t))return!0;return!1}function U(t){try{return JSON.stringify(t)}catch(s){var e,r;return JSON.stringify((e=[],r=[],function t(s,n){var i,o,a;switch(typeof s){case"object":if(!s)return null;for(i=0;i<e.length;i+=1)if(e[i]===s)return{$ref:r[i]};if(e.push(s),r.push(n),"[object Array]"===Object.prototype.toString.apply(s))for(i=0,a=[];i<s.length;i+=1)a[i]=t(s[i],n+"["+i+"]");else for(o in a={},s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=t(s[o],n+"["+JSON.stringify(o)+"]"));return a;case"number":case"string":case"boolean":return s}}(t,"$")))}}var D={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"}};function I(t,e,r){return t+(e.useTLS?"s":"")+"://"+(e.useTLS?e.hostTLS:e.hostNonTLS)+r}function M(t,e){return"/app/"+t+("?protocol="+D.PROTOCOL+"&client=js&version=")+D.VERSION+(e?"&"+e:"")}class H{constructor(){this._callbacks={}}get(t){return this._callbacks["_"+t]}add(t,e,r){var s="_"+t;this._callbacks[s]=this._callbacks[s]||[],this._callbacks[s].push({fn:e,context:r})}remove(t,e,r){if(!t&&!e&&!r){this._callbacks={};return}var s=t?["_"+t]:T(this._callbacks);e||r?this.removeCallback(s,e,r):this.removeAllCallbacks(s)}removeCallback(t,e,r){P(t,function(t){this._callbacks[t]=R(this._callbacks[t]||[],function(t){return e&&e!==t.fn||r&&r!==t.context}),0===this._callbacks[t].length&&delete this._callbacks[t]},this)}removeAllCallbacks(t){P(t,function(t){delete this._callbacks[t]},this)}}class B{constructor(t){this.callbacks=new H,this.global_callbacks=[],this.failThrough=t}bind(t,e,r){return this.callbacks.add(t,e,r),this}bind_global(t){return this.global_callbacks.push(t),this}unbind(t,e,r){return this.callbacks.remove(t,e,r),this}unbind_global(t){return t?this.global_callbacks=R(this.global_callbacks||[],e=>e!==t):this.global_callbacks=[],this}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(t,e,r){for(var s=0;s<this.global_callbacks.length;s++)this.global_callbacks[s](t,e);var n=this.callbacks.get(t),i=[];if(r?i.push(e,r):e&&i.push(e),n&&n.length>0)for(var s=0;s<n.length;s++)n[s].fn.apply(n[s].context||global,i);else this.failThrough&&this.failThrough(t,e);return this}}class q{constructor(){this.globalLog=t=>{global.console&&global.console.log&&global.console.log(t)}}debug(...t){this.log(this.globalLog,t)}warn(...t){this.log(this.globalLogWarn,t)}error(...t){this.log(this.globalLogError,t)}globalLogWarn(t){global.console&&global.console.warn?global.console.warn(t):this.globalLog(t)}globalLogError(t){global.console&&global.console.error?global.console.error(t):this.globalLogWarn(t)}log(t,...e){var r=C.apply(this,arguments);ep.log?ep.log(r):ep.logToConsole&&t.bind(this)(r)}}var j=new q;class z extends B{constructor(t,e,r,s,n){super(),this.initialize=t8.transportConnectionInitializer,this.hooks=t,this.name=e,this.priority=r,this.key=s,this.options=n,this.state="new",this.timeline=n.timeline,this.activityTimeout=n.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||"initialized"!==this.state)return!1;var t=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(t,this.options)}catch(t){return E.defer(()=>{this.onError(t),this.changeState("closed")}),!1}return this.bindListeners(),j.debug("Connecting",{transport:this.name,url:t}),this.changeState("connecting"),!0}close(){return!!this.socket&&(this.socket.close(),!0)}send(t){return"open"===this.state&&(E.defer(()=>{this.socket&&this.socket.send(t)}),!0)}ping(){"open"===this.state&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(t){this.emit("error",{type:"WebSocketError",error:t}),this.timeline.error(this.buildTimelineMessage({error:t.toString()}))}onClose(t){t?this.changeState("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(t){this.emit("message",t)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=t=>{this.onError(t)},this.socket.onclose=t=>{this.onClose(t)},this.socket.onmessage=t=>{this.onMessage(t)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(t,e){this.state=t,this.timeline.info(this.buildTimelineMessage({state:t,params:e})),this.emit(t,e)}buildTimelineMessage(t){return w({cid:this.id},t)}}class F{constructor(t){this.hooks=t}isSupported(t){return this.hooks.isSupported(t)}createConnection(t,e,r,s){return new z(this.hooks,t,e,r,s)}}var K=new F({urls:{getInitial:function(t,e){var r=(e.httpPath||"")+M(t,"flash=false");return I("ws",e,r)}},handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!t8.getWebSocketAPI()},isSupported:function(){return!!t8.getWebSocketAPI()},getSocket:function(t){return t8.createWebSocket(t)}}),G={urls:{getInitial:function(t,e){var r=(e.httpPath||"/pusher")+M(t);return I("http",e,r)}},handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},Y=w({getSocket:function(t){return t8.HTTPFactory.createStreamingSocket(t)}},G),W=w({getSocket:function(t){return t8.HTTPFactory.createPollingSocket(t)}},G),V={isSupported:function(){return t8.isXHRSupported()}},$={ws:K,xhr_streaming:new F(w({},Y,V)),xhr_polling:new F(w({},W,V))};class X{constructor(t,e,r){this.manager=t,this.transport=e,this.minPingDelay=r.minPingDelay,this.maxPingDelay=r.maxPingDelay,this.pingDelay=void 0}createConnection(t,e,r,s){s=w({},s,{activityTimeout:this.pingDelay});var n=this.transport.createConnection(t,e,r,s),i=null,o=function(){n.unbind("open",o),n.bind("closed",a),i=E.now()},a=t=>{if(n.unbind("closed",a),1002===t.code||1003===t.code)this.manager.reportDeath();else if(!t.wasClean&&i){var e=E.now()-i;e<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(e/2,this.minPingDelay))}};return n.bind("open",o),n}isSupported(t){return this.manager.isAlive()&&this.transport.isSupported(t)}}let J={decodeMessage:function(t){try{var e=JSON.parse(t.data),r=e.data;if("string"==typeof r)try{r=JSON.parse(e.data)}catch(t){}var s={event:e.event,channel:e.channel,data:r};return e.user_id&&(s.user_id=e.user_id),s}catch(e){throw{type:"MessageParseError",error:e,data:t.data}}},encodeMessage:function(t){return JSON.stringify(t)},processHandshake:function(t){var e=J.decodeMessage(t);if("pusher:connection_established"===e.event){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:1e3*e.data.activity_timeout}}if("pusher:error"===e.event)return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"},getCloseAction:function(t){return t.code<4e3?t.code>=1002&&t.code<=1004?"backoff":null:4e3===t.code?"tls_only":t.code<4100?"refused":t.code<4200?"backoff":t.code<4300?"retry":"refused"},getCloseError:function(t){return 1e3!==t.code&&1001!==t.code?{type:"PusherError",data:{code:t.code,message:t.reason||t.message}}:null}};class Z extends B{constructor(t,e){super(),this.id=t,this.transport=e,this.activityTimeout=e.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(t){return this.transport.send(t)}send_event(t,e,r){var s={event:t,data:e};return r&&(s.channel=r),j.debug("Event sent",s),this.send(J.encodeMessage(s))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var t={message:t=>{var e;try{e=J.decodeMessage(t)}catch(e){this.emit("error",{type:"MessageParseError",error:e,data:t.data})}if(void 0!==e){switch(j.debug("Event recd",e),e.event){case"pusher:error":this.emit("error",{type:"PusherError",data:e.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong")}this.emit("message",e)}},activity:()=>{this.emit("activity")},error:t=>{this.emit("error",t)},closed:t=>{e(),t&&t.code&&this.handleCloseEvent(t),this.transport=null,this.emit("closed")}},e=()=>{O(t,(t,e)=>{this.transport.unbind(e,t)})};O(t,(t,e)=>{this.transport.bind(e,t)})}handleCloseEvent(t){var e=J.getCloseAction(t),r=J.getCloseError(t);r&&this.emit("error",r),e&&this.emit(e,{action:e,error:r})}}class Q{constructor(t,e){this.transport=t,this.callback=e,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=t=>{var e;this.unbindListeners();try{e=J.processHandshake(t)}catch(t){this.finish("error",{error:t}),this.transport.close();return}"connected"===e.action?this.finish("connected",{connection:new Z(e.id,this.transport),activityTimeout:e.activityTimeout}):(this.finish(e.action,{error:e.error}),this.transport.close())},this.onClosed=t=>{this.unbindListeners();var e=J.getCloseAction(t)||"backoff",r=J.getCloseError(t);this.finish(e,{error:r})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(t,e){this.callback(w({transport:this.transport,action:t},e))}}class tt{constructor(t,e){this.timeline=t,this.options=e||{}}send(t,e){this.timeline.isEmpty()||this.timeline.send(t8.TimelineTransport.getAgent(this,t),e)}}class te extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class tr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class ts extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class tn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class ti extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class to extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class ta extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class th extends Error{constructor(t,e){super(e),this.status=t,Object.setPrototypeOf(this,new.target.prototype)}}let tc={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var tu={buildLogSuffix:function(t){let e;let r=tc.urls[t];return r&&(r.fullUrl?e=r.fullUrl:r.path&&(e=tc.baseUrl+r.path),e)?`See: ${e}`:""}};class tl extends B{constructor(t,e){super(function(e,r){j.debug("No callbacks on "+t+" for "+e)}),this.name=t,this.pusher=e,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(t,e){return e(null,{auth:""})}trigger(t,e){if(0!==t.indexOf("client-"))throw new te("Event '"+t+"' does not start with 'client-'");if(!this.subscribed){var r=tu.buildLogSuffix("triggeringClientEvents");j.warn(`Client event triggered before channel 'subscription_succeeded' event . ${r}`)}return this.pusher.send_event(t,e,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(t){var e=t.event,r=t.data;"pusher_internal:subscription_succeeded"===e?this.handleSubscriptionSucceededEvent(t):"pusher_internal:subscription_count"===e?this.handleSubscriptionCountEvent(t):0!==e.indexOf("pusher_internal:")&&this.emit(e,r,{})}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",t.data)}handleSubscriptionCountEvent(t){t.data.subscription_count&&(this.subscriptionCount=t.data.subscription_count),this.emit("pusher:subscription_count",t.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(t,e)=>{t?(this.subscriptionPending=!1,j.error(t.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:t.message},t instanceof th?{status:t.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:e.auth,channel_data:e.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class td extends tl{authorize(t,e){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:t},e)}}class tf{constructor(){this.reset()}get(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null}each(t){O(this.members,(e,r)=>{t(this.get(r))})}setMyID(t){this.myID=t}onSubscription(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)}addMember(t){return null===this.get(t.user_id)&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)}removeMember(t){var e=this.get(t.user_id);return e&&(delete this.members[t.user_id],this.count--),e}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}class tp extends td{constructor(t,e){super(t,e),this.members=new tf}authorize(t,e){super.authorize(t,(t,r)=>{var s,n,i,o;return s=this,n=void 0,i=void 0,o=function*(){if(!t){if(null!=r.channel_data){var s=JSON.parse(r.channel_data);this.members.setMyID(s.user_id)}else if(yield this.pusher.user.signinDonePromise,null!=this.pusher.user.user_data)this.members.setMyID(this.pusher.user.user_data.id);else{let t=tu.buildLogSuffix("authorizationEndpoint");j.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${t}, or the user should be signed in.`),e("Invalid auth response");return}}e(t,r)},new(i||(i=Promise))(function(t,e){function r(t){try{h(o.next(t))}catch(t){e(t)}}function a(t){try{h(o.throw(t))}catch(t){e(t)}}function h(e){var s;e.done?t(e.value):((s=e.value)instanceof i?s:new i(function(t){t(s)})).then(r,a)}h((o=o.apply(s,n||[])).next())})})}handleEvent(t){var e=t.event;if(0===e.indexOf("pusher_internal:"))this.handleInternalEvent(t);else{var r=t.data,s={};t.user_id&&(s.user_id=t.user_id),this.emit(e,r,s)}}handleInternalEvent(t){var e=t.event,r=t.data;switch(e){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(t);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(t);break;case"pusher_internal:member_added":var s=this.members.addMember(r);this.emit("pusher:member_added",s);break;case"pusher_internal:member_removed":var n=this.members.removeMember(r);n&&this.emit("pusher:member_removed",n)}}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(t.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var tg=r(17),t_=r(8);class tv extends td{constructor(t,e,r){super(t,e),this.key=null,this.nacl=r}authorize(t,e){super.authorize(t,(t,r)=>{if(t){e(t,r);return}let s=r.shared_secret;if(!s){e(Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(t_.decode)(s),delete r.shared_secret,e(null,r)})}trigger(t,e){throw new ti("Client events are not currently supported for encrypted channels")}handleEvent(t){var e=t.event,r=t.data;if(0===e.indexOf("pusher_internal:")||0===e.indexOf("pusher:")){super.handleEvent(t);return}this.handleEncryptedEvent(e,r)}handleEncryptedEvent(t,e){if(!this.key){j.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!e.ciphertext||!e.nonce){j.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+e);return}let r=Object(t_.decode)(e.ciphertext);if(r.length<this.nacl.secretbox.overheadLength){j.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${r.length}`);return}let s=Object(t_.decode)(e.nonce);if(s.length<this.nacl.secretbox.nonceLength){j.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${s.length}`);return}let n=this.nacl.secretbox.open(r,s,this.key);if(null===n){j.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(e,i)=>{if(e){j.error(`Failed to make a request to the authEndpoint: ${i}. Unable to fetch new key, so dropping encrypted event`);return}if(null===(n=this.nacl.secretbox.open(r,s,this.key))){j.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(t,this.getDataToEmit(n))});return}this.emit(t,this.getDataToEmit(n))}getDataToEmit(t){let e=Object(tg.decode)(t);try{return JSON.parse(e)}catch(t){return e}}}class tm extends B{constructor(t,e){super(),this.state="initialized",this.connection=null,this.key=t,this.options=e,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var r=t8.getNetwork();r.bind("online",()=>{this.timeline.info({netinfo:"online"}),("connecting"===this.state||"unavailable"===this.state)&&this.retryIn(0)}),r.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!this.connection&&!this.runner){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(t){return!!this.connection&&this.connection.send(t)}send_event(t,e,r){return!!this.connection&&this.connection.send_event(t,e,r)}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var t=(e,r)=>{e?this.runner=this.strategy.connect(0,t):"error"===r.action?(this.emit("error",{type:"HandshakeError",error:r.error}),this.timeline.error({handshakeError:r.error})):(this.abortConnecting(),this.handshakeCallbacks[r.action](r))};this.runner=this.strategy.connect(0,t)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(t){this.timeline.info({action:"retry",delay:t}),t>0&&this.emit("connecting_in",Math.round(t/1e3)),this.retryTimer=new x(t||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new x(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new x(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new x(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(t){return w({},t,{message:t=>{this.resetActivityCheck(),this.emit("message",t)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:t=>{this.emit("error",t)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(t){return w({},t,{connected:t=>{this.activityTimeout=Math.min(this.options.activityTimeout,t.activityTimeout,t.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(t.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let t=t=>e=>{e.error&&this.emit("error",{type:"WebSocketError",error:e.error}),t(e)};return{tls_only:t(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:t(()=>{this.disconnect()}),backoff:t(()=>{this.retryIn(1e3)}),retry:t(()=>{this.retryIn(0)})}}setConnection(t){for(var e in this.connection=t,this.connectionCallbacks)this.connection.bind(e,this.connectionCallbacks[e]);this.resetActivityCheck()}abandonConnection(){if(this.connection){for(var t in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(t,this.connectionCallbacks[t]);var e=this.connection;return this.connection=null,e}}updateState(t,e){var r=this.state;if(this.state=t,r!==t){var s=t;"connected"===s&&(s+=" with new socket ID "+e.socket_id),j.debug("State changed",r+" -> "+s),this.timeline.info({state:t,params:e}),this.emit("state_change",{previous:r,current:t}),this.emit(t,e)}}shouldRetry(){return"connecting"===this.state||"connected"===this.state}}class tb{constructor(){this.channels={}}add(t,e){return this.channels[t]||(this.channels[t]=function(t,e){if(0===t.indexOf("private-encrypted-")){if(e.config.nacl)return ty.createEncryptedChannel(t,e,e.config.nacl);let r=tu.buildLogSuffix("encryptedChannelSupport");throw new ti(`Tried to subscribe to a private-encrypted- channel but no nacl implementation available. ${r}`)}if(0===t.indexOf("private-"))return ty.createPrivateChannel(t,e);if(0===t.indexOf("presence-"))return ty.createPresenceChannel(t,e);if(0!==t.indexOf("#"))return ty.createChannel(t,e);throw new tr('Cannot create a channel with name "'+t+'".')}(t,e)),this.channels[t]}all(){var t,e;return t=this.channels,e=[],O(t,function(t){e.push(t)}),e}find(t){return this.channels[t]}remove(t){var e=this.channels[t];return delete this.channels[t],e}disconnect(){O(this.channels,function(t){t.disconnect()})}}var ty={createChannels:()=>new tb,createConnectionManager:(t,e)=>new tm(t,e),createChannel:(t,e)=>new tl(t,e),createPrivateChannel:(t,e)=>new td(t,e),createPresenceChannel:(t,e)=>new tp(t,e),createEncryptedChannel:(t,e,r)=>new tv(t,e,r),createTimelineSender:(t,e)=>new tt(t,e),createHandshake:(t,e)=>new Q(t,e),createAssistantToTheTransportManager:(t,e,r)=>new X(t,e,r)};class tx{constructor(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}getAssistant(t){return ty.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class tS{constructor(t,e){this.strategies=t,this.loop=!!e.loop,this.failFast=!!e.failFast,this.timeout=e.timeout,this.timeoutLimit=e.timeoutLimit}isSupported(){return L(this.strategies,E.method("isSupported"))}connect(t,e){var r=this.strategies,s=0,n=this.timeout,i=null,o=(a,h)=>{h?e(null,h):(s+=1,this.loop&&(s%=r.length),s<r.length?(n&&(n*=2,this.timeoutLimit&&(n=Math.min(n,this.timeoutLimit))),i=this.tryStrategy(r[s],t,{timeout:n,failFast:this.failFast},o)):e(!0))};return i=this.tryStrategy(r[s],t,{timeout:n,failFast:this.failFast},o),{abort:function(){i.abort()},forceMinPriority:function(e){t=e,i&&i.forceMinPriority(e)}}}tryStrategy(t,e,r,s){var n=null,i=null;return r.timeout>0&&(n=new x(r.timeout,function(){i.abort(),s(!0)})),i=t.connect(e,function(t,e){(!(t&&n&&n.isRunning())||r.failFast)&&(n&&n.ensureAborted(),s(t,e))}),{abort:function(){n&&n.ensureAborted(),i.abort()},forceMinPriority:function(t){i.forceMinPriority(t)}}}}class tE{constructor(t){this.strategies=t}isSupported(){return L(this.strategies,E.method("isSupported"))}connect(t,e){var r,s,n;return r=this.strategies,s=function(t,r){return function(s,n){if(r[t].error=s,s){(function(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r,t))return!1;return!0})(r,function(t){return!!t.error})&&e(!0);return}P(r,function(t){t.forceMinPriority(n.transport.priority)}),e(null,n)}},n=A(r,function(e,r,n,i){return e.connect(t,s(r,i))}),{abort:function(){P(n,tw)},forceMinPriority:function(t){P(n,function(e){e.forceMinPriority(t)})}}}}function tw(t){t.error||t.aborted||(t.abort(),t.aborted=!0)}class tC{constructor(t,e,r){this.strategy=t,this.transports=e,this.ttl=r.ttl||18e5,this.usingTLS=r.useTLS,this.timeline=r.timeline}isSupported(){return this.strategy.isSupported()}connect(t,e){var r=this.usingTLS,s=function(t){var e=t8.getLocalStorage();if(e)try{var r=e[tk(t)];if(r)return JSON.parse(r)}catch(e){tO(t)}return null}(r),n=s&&s.cacheSkipCount?s.cacheSkipCount:0,i=[this.strategy];if(s&&s.timestamp+this.ttl>=E.now()){var o=this.transports[s.transport];o&&(["ws","wss"].includes(s.transport)||n>3?(this.timeline.info({cached:!0,transport:s.transport,latency:s.latency}),i.push(new tS([o],{timeout:2*s.latency+1e3,failFast:!0}))):n++)}var a=E.now(),h=i.pop().connect(t,function s(o,c){o?(tO(r),i.length>0?(a=E.now(),h=i.pop().connect(t,s)):e(o)):(function(t,e,r,s){var n=t8.getLocalStorage();if(n)try{n[tk(t)]=U({timestamp:E.now(),transport:e,latency:r,cacheSkipCount:s})}catch(t){}}(r,c.transport.name,E.now()-a,n),e(null,c))});return{abort:function(){h.abort()},forceMinPriority:function(e){t=e,h&&h.forceMinPriority(e)}}}}function tk(t){return"pusherTransport"+(t?"TLS":"NonTLS")}function tO(t){var e=t8.getLocalStorage();if(e)try{delete e[tk(t)]}catch(t){}}class tT{constructor(t,{delay:e}){this.strategy=t,this.options={delay:e}}isSupported(){return this.strategy.isSupported()}connect(t,e){var r,s=this.strategy,n=new x(this.options.delay,function(){r=s.connect(t,e)});return{abort:function(){n.ensureAborted(),r&&r.abort()},forceMinPriority:function(e){t=e,r&&r.forceMinPriority(e)}}}}class tP{constructor(t,e,r){this.test=t,this.trueBranch=e,this.falseBranch=r}isSupported(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()}connect(t,e){return(this.test()?this.trueBranch:this.falseBranch).connect(t,e)}}class tA{constructor(t){this.strategy=t}isSupported(){return this.strategy.isSupported()}connect(t,e){var r=this.strategy.connect(t,function(t,s){s&&r.abort(),e(t,s)});return r}}function tR(t){return function(){return t.isSupported()}}class tN extends B{constructor(t,e,r){super(),this.hooks=t,this.method=e,this.url=r}start(t){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},t8.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(t)}close(){this.unloader&&(t8.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(t,e){for(;;){var r=this.advanceBuffer(e);if(r)this.emit("chunk",{status:t,data:r});else break}this.isBufferTooLong(e)&&this.emit("buffer_too_long")}advanceBuffer(t){var e=t.slice(this.position),r=e.indexOf("\n");return -1!==r?(this.position+=r+1,e.slice(0,r)):null}isBufferTooLong(t){return this.position===t.length&&t.length>262144}}(s=o||(o={}))[s.CONNECTING=0]="CONNECTING",s[s.OPEN=1]="OPEN",s[s.CLOSED=3]="CLOSED";var tL=o,tU=1;class tD{constructor(t,e){var r;this.hooks=t,this.session=tM(1e3)+"/"+function(t){for(var e=[],r=0;r<8;r++)e.push(tM(32).toString(32));return e.join("")}(0),this.location={base:(r=/([^\?]*)\/*(\??.*)/.exec(e))[1],queryString:r[2]},this.readyState=tL.CONNECTING,this.openStream()}send(t){return this.sendRaw(JSON.stringify([t]))}ping(){this.hooks.sendHeartbeat(this)}close(t,e){this.onClose(t,e,!0)}sendRaw(t){if(this.readyState!==tL.OPEN)return!1;try{var e,r;return t8.createSocketRequest("POST",tI((e=this.location,r=this.session,e.base+"/"+r+"/xhr_send"))).start(t),!0}catch(t){return!1}}reconnect(){this.closeStream(),this.openStream()}onClose(t,e,r){this.closeStream(),this.readyState=tL.CLOSED,this.onclose&&this.onclose({code:t,reason:e,wasClean:r})}onChunk(t){if(200===t.status)switch(this.readyState===tL.OPEN&&this.onActivity(),t.data.slice(0,1)){case"o":e=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(e);break;case"a":e=JSON.parse(t.data.slice(1)||"[]");for(var e,r=0;r<e.length;r++)this.onEvent(e[r]);break;case"m":e=JSON.parse(t.data.slice(1)||"null"),this.onEvent(e);break;case"h":this.hooks.onHeartbeat(this);break;case"c":e=JSON.parse(t.data.slice(1)||"[]"),this.onClose(e[0],e[1],!0)}}onOpen(t){var e,r,s;this.readyState===tL.CONNECTING?(t&&t.hostname&&(this.location.base=(e=this.location.base,r=t.hostname,(s=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(e))[1]+r+s[3])),this.readyState=tL.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(t){this.readyState===tL.OPEN&&this.onmessage&&this.onmessage({data:t})}onActivity(){this.onactivity&&this.onactivity()}onError(t){this.onerror&&this.onerror(t)}openStream(){this.stream=t8.createSocketRequest("POST",tI(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",t=>{this.onChunk(t)}),this.stream.bind("finished",t=>{this.hooks.onFinished(this,t)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(t){E.defer(()=>{this.onError(t),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function tI(t){var e=-1===t.indexOf("?")?"?":"&";return t+e+"t="+ +new Date+"&n="+tU++}function tM(t){return t8.randomInt(t)}var tH={getReceiveURL:function(t,e){return t.base+"/"+e+"/xhr_streaming"+t.queryString},onHeartbeat:function(t){t.sendRaw("[]")},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,e){t.onClose(1006,"Connection interrupted ("+e+")",!1)}},tB={getReceiveURL:function(t,e){return t.base+"/"+e+"/xhr"+t.queryString},onHeartbeat:function(){},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,e){200===e?t.reconnect():t.onClose(1006,"Connection interrupted ("+e+")",!1)}},tq={getRequest:function(t){var e=new(t8.getXHRAPI());return e.onreadystatechange=e.onprogress=function(){switch(e.readyState){case 3:e.responseText&&e.responseText.length>0&&t.onChunk(e.status,e.responseText);break;case 4:e.responseText&&e.responseText.length>0&&t.onChunk(e.status,e.responseText),t.emit("finished",e.status),t.close()}},e},abortRequest:function(t){t.onreadystatechange=null,t.abort()}},tj=r(18),tz=r(19);class tF extends B{isOnline(){return!0}}var tK=new tF;(n=a||(a={})).UserAuthentication="user-authentication",n.ChannelAuthorization="channel-authorization";var tG=function(t,e,r,s,n){let i=t8.createXHR();for(var o in i.open("POST",r.endpoint,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.headers)i.setRequestHeader(o,r.headers[o]);if(null!=r.headersProvider){let t=r.headersProvider();for(var o in t)i.setRequestHeader(o,t[o])}return i.onreadystatechange=function(){if(4===i.readyState){if(200===i.status){let t;let e=!1;try{t=JSON.parse(i.responseText),e=!0}catch(t){n(new th(200,`JSON returned from ${s.toString()} endpoint was invalid, yet status code was 200. Data was: ${i.responseText}`),null)}e&&n(null,t)}else{let t="";switch(s){case a.UserAuthentication:t=tu.buildLogSuffix("authenticationEndpoint");break;case a.ChannelAuthorization:t=`Clients must be authorized to join private or presence channels. ${tu.buildLogSuffix("authorizationEndpoint")}`}n(new th(i.status,`Unable to retrieve auth string from ${s.toString()} endpoint - received status: ${i.status} from ${r.endpoint}. ${t}`),null)}}},i.send(e),i},tY=r(3);let{getDefaultStrategy:tW,Transports:tV,setup:t$,getProtocol:tX,isXHRSupported:tJ,getLocalStorage:tZ,createXHR:tQ,createWebSocket:t5,addUnloadListener:t1,removeUnloadListener:t0,transportConnectionInitializer:t2,createSocketRequest:t6,HTTPFactory:t3}={getDefaultStrategy:function(t,e,r){var s,n={};function i(e,s,i,o,a){var h=r(t,e,s,i,o,a);return n[e]=h,h}var o=Object.assign({},e,{hostNonTLS:t.wsHost+":"+t.wsPort,hostTLS:t.wsHost+":"+t.wssPort,httpPath:t.wsPath}),a=w({},o,{useTLS:!0}),h=Object.assign({},e,{hostNonTLS:t.httpHost+":"+t.httpPort,hostTLS:t.httpHost+":"+t.httpsPort,httpPath:t.httpPath}),c={loop:!0,timeout:15e3,timeoutLimit:6e4},u=new tx({minPingDelay:1e4,maxPingDelay:t.activityTimeout}),l=new tx({lives:2,minPingDelay:1e4,maxPingDelay:t.activityTimeout}),d=i("ws","ws",3,o,u),f=i("wss","ws",3,a,u),p=i("xhr_streaming","xhr_streaming",1,h,l),g=i("xhr_polling","xhr_polling",1,h),_=new tS([d],c),v=new tS([f],c),m=new tS([p],c),b=new tS([g],c),y=new tS([new tP(tR(m),new tE([m,new tT(b,{delay:4e3})]),b)],c);return s=new tE(e.useTLS?[_,new tT(y,{delay:2e3})]:[_,new tT(v,{delay:2e3}),new tT(y,{delay:5e3})]),new tC(new tA(new tP(tR(d),s,y)),n,{ttl:18e5,timeline:e.timeline,useTLS:e.useTLS})},Transports:$,transportConnectionInitializer:function(){this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.useTLS?"s":"")})),this.hooks.isInitialized()?this.changeState("initialized"):this.onClose()},HTTPFactory:{createStreamingSocket(t){return this.createSocket(tH,t)},createPollingSocket(t){return this.createSocket(tB,t)},createSocket:(t,e)=>new tD(t,e),createXHR(t,e){return this.createRequest(tq,t,e)},createRequest:(t,e,r)=>new tN(t,e,r)},setup(t){t.ready()},getLocalStorage(){},getClientFeatures:()=>T(N({ws:$.ws},function(t){return t.isSupported({})})),getProtocol:()=>"http:",isXHRSupported:()=>!0,createSocketRequest(t,e){if(this.isXHRSupported())return this.HTTPFactory.createXHR(t,e);throw"Cross-origin HTTP requests are not supported"},createXHR(){return new(this.getXHRAPI())},createWebSocket(t){return new(this.getWebSocketAPI())(t)},addUnloadListener(t){},removeUnloadListener(t){}};var t8={getDefaultStrategy:tW,Transports:tV,setup:t$,getProtocol:tX,isXHRSupported:tJ,createSocketRequest:t6,getLocalStorage:tZ,createXHR:tQ,createWebSocket:t5,addUnloadListener:t1,removeUnloadListener:t0,transportConnectionInitializer:t2,HTTPFactory:t3,TimelineTransport:{name:"xhr",getAgent:function(t,e){return function(r,s){var n,i,o,a,h="http"+(e?"s":"")+"://"+(t.host||t.options.host)+t.options.path;h+="/2?"+A((n=N(r,function(t){return void 0!==t}),i=function(t){return"object"==typeof t&&(t=U(t)),encodeURIComponent(_(t.toString().replace(/[^\x00-\x7F]/g,p)))},o={},O(n,function(t,e){o[e]=i(t)}),a=[],O(o,function(t,e){a.push([e,t])}),a),E.method("join","=")).join("&");var c=t8.createXHR();c.open("GET",h,!0),c.onreadystatechange=function(){if(4===c.readyState){let{status:r,responseText:s}=c;if(200!==r){j.debug(`TimelineSender Error: received ${r} from stats.pusher.com`);return}try{var{host:e}=JSON.parse(s)}catch(t){j.debug(`TimelineSenderError: invalid response ${s}`)}e&&(t.host=e)}},c.send()}}},getAuthorizers:()=>({ajax:tG}),getWebSocketAPI:()=>tj.Client,getXHRAPI:()=>tz.XMLHttpRequest,getNetwork:()=>tK,randomInt:t=>Object(tY.randomInt)(t)};(i=h||(h={}))[i.ERROR=3]="ERROR",i[i.INFO=6]="INFO",i[i.DEBUG=7]="DEBUG";var t4=h;class t9{constructor(t,e,r){this.key=t,this.session=e,this.events=[],this.options=r||{},this.sent=0,this.uniqueID=0}log(t,e){t<=this.options.level&&(this.events.push(w({},e,{timestamp:E.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(t){this.log(t4.ERROR,t)}info(t){this.log(t4.INFO,t)}debug(t){this.log(t4.DEBUG,t)}isEmpty(){return 0===this.events.length}send(t,e){var r=w({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(r,(t,r)=>{!t&&this.sent++,e&&e(t,r)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class t7{constructor(t,e,r,s){this.name=t,this.priority=e,this.transport=r,this.options=s||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(t,e){if(!this.isSupported())return et(new ta,e);if(this.priority<t)return et(new ts,e);var r=!1,s=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),n=null,i=function(){s.unbind("initialized",i),s.connect()},o=function(){n=ty.createHandshake(s,function(t){r=!0,c(),e(null,t)})},a=function(t){c(),e(t)},h=function(){c(),e(new tn(U(s)))},c=function(){s.unbind("initialized",i),s.unbind("open",o),s.unbind("error",a),s.unbind("closed",h)};return s.bind("initialized",i),s.bind("open",o),s.bind("error",a),s.bind("closed",h),s.initialize(),{abort:()=>{r||(c(),n?n.close():s.close())},forceMinPriority:t=>{!r&&this.priority<t&&(n?n.close():s.close())}}}}function et(t,e){return E.defer(function(){e(t)}),{abort:function(){},forceMinPriority:function(){}}}let{Transports:ee}=t8;var er=function(t,e,r,s,n,i){var o,a=ee[r];if(!a)throw new to(r);return t.enabledTransports&&-1===k(t.enabledTransports,e)||t.disabledTransports&&-1!==k(t.disabledTransports,e)?o=es:(n=Object.assign({ignoreNullOrigin:t.ignoreNullOrigin},n),o=new t7(e,s,i?i.getAssistant(a):a,n)),o},es={isSupported:function(){return!1},connect:function(t,e){var r=E.defer(function(){e(new ta)});return{abort:function(){r.ensureAborted()},forceMinPriority:function(){}}}};function en(t){if(null==t)throw"You must pass an options object";if(null==t.cluster)throw"Options object must provide a cluster";"disableStats"in t&&j.warn("The disableStats option is deprecated in favor of enableStats")}let ei=(t,e)=>{var r="socket_id="+encodeURIComponent(t.socketId);for(var s in e.params)r+="&"+encodeURIComponent(s)+"="+encodeURIComponent(e.params[s]);if(null!=e.paramsProvider){let t=e.paramsProvider();for(var s in t)r+="&"+encodeURIComponent(s)+"="+encodeURIComponent(t[s])}return r};var eo=t=>{if(void 0===t8.getAuthorizers()[t.transport])throw`'${t.transport}' is not a recognized auth transport`;return(e,r)=>{let s=ei(e,t);t8.getAuthorizers()[t.transport](t8,s,t,a.UserAuthentication,r)}};let ea=(t,e)=>{var r="socket_id="+encodeURIComponent(t.socketId);for(var s in r+="&channel_name="+encodeURIComponent(t.channelName),e.params)r+="&"+encodeURIComponent(s)+"="+encodeURIComponent(e.params[s]);if(null!=e.paramsProvider){let t=e.paramsProvider();for(var s in t)r+="&"+encodeURIComponent(s)+"="+encodeURIComponent(t[s])}return r};var eh=t=>{if(void 0===t8.getAuthorizers()[t.transport])throw`'${t.transport}' is not a recognized auth transport`;return(e,r)=>{let s=ea(e,t);t8.getAuthorizers()[t.transport](t8,s,t,a.ChannelAuthorization,r)}};let ec=(t,e,r)=>{let s={authTransport:e.transport,authEndpoint:e.endpoint,auth:{params:e.params,headers:e.headers}};return(e,n)=>{r(t.channel(e.channelName),s).authorize(e.socketId,n)}};class eu extends B{constructor(t){super(function(t,e){j.debug(`No callbacks on watchlist events for ${t}`)}),this.pusher=t,this.bindWatchlistInternalEvent()}handleEvent(t){t.data.events.forEach(t=>{this.emit(t.name,t)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",t=>{"pusher_internal:watchlist_events"===t.event&&this.handleEvent(t)})}}var el=function(){let t,e;return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}};class ed extends B{constructor(t){super(function(t,e){j.debug("No callbacks on user for "+t)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(t,e)=>{if(t){j.warn(`Error during signin: ${t}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:e.auth,user_data:e.user_data})},this.pusher=t,this.pusher.connection.bind("state_change",({previous:t,current:e})=>{"connected"!==t&&"connected"===e&&this._signin(),"connected"===t&&"connected"!==e&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new eu(t),this.pusher.connection.bind("message",t=>{"pusher:signin_success"===t.event&&this._onSigninSuccess(t.data),this.serverToUserChannel&&this.serverToUserChannel.name===t.channel&&this.serverToUserChannel.handleEvent(t)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),"connected"===this.pusher.connection.state&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(t){try{this.user_data=JSON.parse(t.user_data)}catch(e){j.error(`Failed parsing user data after signin: ${t.user_data}`),this._cleanup();return}if("string"!=typeof this.user_data.id||""===this.user_data.id){j.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){this.serverToUserChannel=new tl(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((t,e)=>{0!==t.indexOf("pusher_internal:")&&0!==t.indexOf("pusher:")&&this.emit(t,e)}),(t=>{t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():t.subscriptionPending||"connected"!==this.pusher.connection.state||t.subscribe()})(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;let{promise:t,resolve:e,reject:r}=el();t.done=!1;let s=()=>{t.done=!0};t.then(s).catch(s),this.signinDonePromise=t,this._signinDoneResolve=e}}class ef{static ready(){ef.isReady=!0;for(var t=0,e=ef.instances.length;t<e;t++)ef.instances[t].connect()}static getClientFeatures(){return T(N({ws:t8.Transports.ws},function(t){return t.isSupported({})}))}constructor(t,e){var r;let s;(function(t){if(null==t)throw"You must pass your app key when you instantiate Pusher."})(t),en(e),this.key=t,this.config=(s={activityTimeout:e.activityTimeout||D.activityTimeout,cluster:e.cluster,httpPath:e.httpPath||D.httpPath,httpPort:e.httpPort||D.httpPort,httpsPort:e.httpsPort||D.httpsPort,pongTimeout:e.pongTimeout||D.pongTimeout,statsHost:e.statsHost||D.stats_host,unavailableTimeout:e.unavailableTimeout||D.unavailableTimeout,wsPath:e.wsPath||D.wsPath,wsPort:e.wsPort||D.wsPort,wssPort:e.wssPort||D.wssPort,enableStats:"enableStats"in e?e.enableStats:"disableStats"in e&&!e.disableStats,httpHost:e.httpHost?e.httpHost:e.cluster?`sockjs-${e.cluster}.pusher.com`:D.httpHost,useTLS:function(t){if("https:"===t8.getProtocol());else if(!1===t.forceTLS)return!1;return!0}(e),wsHost:e.wsHost?e.wsHost:(r=e.cluster,`ws-${r}.pusher.com`),userAuthenticator:function(t){let e=Object.assign(Object.assign({},D.userAuthentication),t.userAuthentication);return"customHandler"in e&&null!=e.customHandler?e.customHandler:eo(e)}(e),channelAuthorizer:function(t,e){let r;let s=("channelAuthorization"in t?r=Object.assign(Object.assign({},D.channelAuthorization),t.channelAuthorization):(r={transport:t.authTransport||D.authTransport,endpoint:t.authEndpoint||D.authEndpoint},"auth"in t&&("params"in t.auth&&(r.params=t.auth.params),"headers"in t.auth&&(r.headers=t.auth.headers)),"authorizer"in t&&(r.customHandler=ec(e,r,t.authorizer))),r);return"customHandler"in s&&null!=s.customHandler?s.customHandler:eh(s)}(e,this)},"disabledTransports"in e&&(s.disabledTransports=e.disabledTransports),"enabledTransports"in e&&(s.enabledTransports=e.enabledTransports),"ignoreNullOrigin"in e&&(s.ignoreNullOrigin=e.ignoreNullOrigin),"timelineParams"in e&&(s.timelineParams=e.timelineParams),"nacl"in e&&(s.nacl=e.nacl),s),this.channels=ty.createChannels(),this.global_emitter=new B,this.sessionID=t8.randomInt(1e9),this.timeline=new t9(this.key,this.sessionID,{cluster:this.config.cluster,features:ef.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:t4.INFO,version:D.VERSION}),this.config.enableStats&&(this.timelineSender=ty.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+t8.TimelineTransport.name})),this.connection=ty.createConnectionManager(this.key,{getStrategy:t=>t8.getDefaultStrategy(this.config,t,er),timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",t=>{var e=0===t.event.indexOf("pusher_internal:");if(t.channel){var r=this.channel(t.channel);r&&r.handleEvent(t)}e||this.global_emitter.emit(t.event,t.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",t=>{j.warn(t)}),ef.instances.push(this),this.timeline.info({instances:ef.instances.length}),this.user=new ed(this),ef.isReady&&this.connect()}channel(t){return this.channels.find(t)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),e=this.timelineSender;this.timelineSenderTimer=new S(6e4,function(){e.send(t)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(t,e,r){return this.global_emitter.bind(t,e,r),this}unbind(t,e,r){return this.global_emitter.unbind(t,e,r),this}bind_global(t){return this.global_emitter.bind_global(t),this}unbind_global(t){return this.global_emitter.unbind_global(t),this}unbind_all(t){return this.global_emitter.unbind_all(),this}subscribeAll(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)}subscribe(t){var e=this.channels.add(t,this);return e.subscriptionPending&&e.subscriptionCancelled?e.reinstateSubscription():e.subscriptionPending||"connected"!==this.connection.state||e.subscribe(),e}unsubscribe(t){var e=this.channels.find(t);e&&e.subscriptionPending?e.cancelSubscription():(e=this.channels.remove(t))&&e.subscribed&&e.unsubscribe()}send_event(t,e,r){return this.connection.send_event(t,e,r)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}ef.instances=[],ef.isReady=!1,ef.logToConsole=!1,ef.Runtime=t8,ef.ScriptReceivers=t8.ScriptReceivers,ef.DependenciesReceivers=t8.DependenciesReceivers,ef.auth_callbacks=t8.auth_callbacks;var ep=ef;t8.setup(ef);var eg=r(20);class e_ extends ep{constructor(t,e){ep.logToConsole=e_.logToConsole,ep.log=e_.log,en(e),e.nacl=eg,super(t,e)}}}])},83748:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var s=r(62740);r(76301);var n=r(59607),i=r.n(n);let o=({children:t})=>(0,s.jsxs)("div",{className:"dashboard-container",children:[(0,s.jsxs)("header",{className:"dashboard-header",children:[(0,s.jsx)("h1",{children:"Dashboard"}),(0,s.jsx)("nav",{children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/dashboard/jobs",children:"Jobs"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/dashboard/profile",children:"Profile"})})]})})]}),(0,s.jsx)("main",{children:t})]})},44082:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>i});var s=r(62740),n=r(25156);function i(){return(0,s.jsx)("div",{className:"container mx-auto py-8",children:(0,s.jsx)(n.ChatLayout,{currentUser:{id:"user-123",name:"Nabil Robbani"}})})}},25156:(t,e,r)=>{"use strict";r.d(e,{ChatLayout:()=>s});let s=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call ChatLayout() from the server but ChatLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\component\\chat\\ChatLayout.tsx","ChatLayout")},59607:(t,e,r)=>{let{createProxy:s}=r(73439);t.exports=s("C:\\Users\\ASUS\\Documents\\my-project\\Recruitment-main\\Recruitment\\frontend\\node_modules\\next\\dist\\client\\app-dir\\link.js")},46055:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var s=r(88077);let n=async t=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await t.params,"favicon.ico")+""}]}};var e=require("../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),s=e.X(0,[638,597,77,9],()=>r(825));module.exports=s})();